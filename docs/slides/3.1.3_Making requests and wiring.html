<!DOCTYPE html>

<!--
Copyright 2010 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Original slides: Marcin Wichary (mwichary@google.com)
Modifications: Ernest Delgado (ernestd@google.com)
Alex Russell (slightlyoff@chromium.org)

landslide modifications: Adam Zapletal (adamzap@gmail.com)
Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, user-scalable=no" name="viewport"/>
<meta content="chrome=1" http-equiv="X-UA-Compatible"/>
<title>Making requests and wiring</title>
<!-- Styles -->
<link href="./fiwaretheme/css/print.css" media="print" rel="stylesheet"/>
<link href="./fiwaretheme/css/screen.css" media="screen, projection" rel="stylesheet"/>
<!-- /Styles -->
<!-- Javascripts -->
<script src="./fiwaretheme/js/slides.js" type="text/javascript"></script>
<!-- /Javascripts -->
</head>
<body>
<div id="blank"></div>
<div class="presentation">
<div id="current_presenter_notes">
<div id="presenter_note"></div>
</div>
<div class="slides">
<div class="slide-wrapper">
<section class="slide cover">
<header class="slide-header"><h1>Making requests and wiring</h1><h2>Application Mashup (WireCloud) course @ https://fiware-academy.readthedocs.io/</h2></header>
<img alt="Image can not be loaded." class="fiware-contact" src="fiwaretheme/images/FIWARE-contact.png"/>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE-full.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops-full.png"/>
<div class="navigation-tip">Use <kbd class="key">←</kbd> and <kbd class="key">→</kbd> to move around. Press <kbd class="key">h</kbd> for getting more info</div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide section-title">
<header class="section-title-header">
<h1>Making requests and wiring</h1>
<h2><h2>Introduction</h2></h2>
</header>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Introduction</h2>
</header>
<div class="contents"><p>In this example, we are going to implement a Weather Widget as an excuse to
learn how to use the most commonly used features of WireCloud from a point of
view of Widgets. Our intention is to create a Widget capable of making AJAX
request to a external service and of communicating with other widgets in a
mashup. This guide does not cover the development of the widget's user
interface, which doesn't have to do with WireCloud and it's based on standard
HTML, JavaScript and CSS code.</p>
<p>First of all, download this initial code from this <a href="attachments/Example1Skel.zip">link</a>. This
code contains a widget example skeleton including basic html/style code.</p>
<p>Also, you will need to create a new API key for the Weather Underground API
using this <a href="http://www.wunderground.com/weather/api/d/login.html">link</a>.</p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            3/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide section-title">
<header class="section-title-header">
<h1>Making requests and wiring</h1>
<h2><h2>Making request to Weather Underground</h2></h2>
</header>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Making request to Weather Underground</h2>
</header>
<div class="contents"><p>Weather Underground provide a rest API for this purpose (documented at
<a href="http://www.wunderground.com/weather/api/d/docs">http://www.wunderground.com/weather/api/d/docs</a>), but
we cannot access this API using normal AJAX request (using <code>XMLHttpRequest</code>) due
browsers applying the <a href="http://en.wikipedia.org/wiki/Same_origin_policy">same origin policy</a> to javascript
code. Fortunately, WireCloud provides the
<a href="https://wirecloud.readthedocs.org/en/latest/widgetapi/widgetapi/#mashupplatformhttpmakerequest-method">MashupPlatform.http.makeRequest</a> method for dealing with this
problem.</p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            5/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide has_code">
<header class="slide-header">
<h2>Making request to Weather Underground</h2>
</header>
<div class="contents"><p>A possible way to access to this API is by using the following code:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">getForecastByCoord</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getForecastByCoord</span><span class="p">(</span><span class="nx">coord</span><span class="p">,</span> <span class="nx">onSuccess</span><span class="p">,</span> <span class="nx">onError</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">url</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">((</span><span class="k">typeof</span> <span class="nx">onSuccess</span> <span class="o">!==</span> <span class="s1">'function'</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">onError</span> <span class="o">!==</span> <span class="s1">'function'</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">url</span> <span class="o">=</span> <span class="s1">'http://api.wunderground.com/api/'</span> <span class="o">+</span> <span class="nx">API_KEY</span> <span class="o">+</span> <span class="s1">'/conditions/forecast/q/'</span><span class="p">;</span>
    <span class="nx">url</span> <span class="o">+=</span> <span class="nx">coord</span><span class="p">.</span><span class="nx">lat</span> <span class="o">+</span> <span class="s1">','</span> <span class="o">+</span> <span class="nx">coord</span><span class="p">.</span><span class="nx">lon</span><span class="p">;</span>
    <span class="nx">url</span> <span class="o">+=</span> <span class="s1">'.json'</span><span class="p">;</span>
    <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="nx">makeRequest</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">'GET'</span><span class="p">,</span>
        <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">forecast_data</span><span class="p">;</span>
            <span class="nx">forecast_data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">forecast_data</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">onError</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">onSuccess</span><span class="p">(</span><span class="nx">forecast_data</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">onError</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">onError</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>
</pre></div>
<p>The <code>getForecastByCoord</code> function makes the appropriated request to Weather
Underground and passes the result to the <code>onSuccess</code> callback.</p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            6/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide section-title">
<header class="section-title-header">
<h1>Making requests and wiring</h1>
<h2><h2>Adding an input endpoint</h2></h2>
</header>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide has_code">
<header class="slide-header">
<h2>Adding an input endpoint</h2>
</header>
<div class="contents"><p>Input endpoints must be declared into the widget template before it can be used
by the javascript code of the widget. To do so, open <code>config.xml</code> and add an
<code>inputendpoint</code> element into the <code>wiring</code> section. The final result should look
like:</p>
<div class="highlight"><pre>...

<span class="nt">&lt;wiring&gt;</span>
    <span class="nt">&lt;inputendpoint</span>
        <span class="na">name=</span><span class="s">"coord"</span>
        <span class="na">type=</span><span class="s">"text"</span>
        <span class="na">label=</span><span class="s">"Show forecast by coord"</span>
        <span class="na">description=</span><span class="s">"Shows the weather forecast for a given location (a latitude longitude coordinate)."</span>
        <span class="na">friendcode=</span><span class="s">"location"</span>
    <span class="nt">/&gt;</span>
<span class="nt">&lt;/wiring&gt;</span>

...
</pre></div>
</div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            8/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Adding an input endpoint</h2>
</header>
<div class="contents"><h3>Input endpoint metadata</h3>
<ul>
<li>The <code>name</code> attribute will be use to reference to the input endpoint when
  using the javascript API</li>
<li>The <code>type</code> attribute defines the type of data this input endpoint will accept,
  currently only "text" (string) is supported.</li>
<li>The <code>label</code> attribute will be used mainly in the Wiring Editor and will be
  the official name by which end users will know the input endpoint. Also, this
  attribute can be translated whereas the name attribute not.</li>
<li>The <code>description</code> attribute is used to provide end user with a description
  of what is going to happen if an event arrives the input endpoint. This
  description is very important for the wiring process as the user needs this
  information for taking decisions on how to wire widgets and operators</li>
<li>The <code>friendcode</code> is used by the Wiring Editor to provide basic wiring
  recommendations. In this case, we are declaring that we accept data produced
  by output endpoints with a friendcode of "location". The format of this data
  is a string with the longitude and the latitude separated by a comma</li>
</ul></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            9/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide has_code">
<header class="slide-header">
<h2>Adding an input endpoint</h2>
</header>
<div class="contents"><p>This is how to declare the input endpoint when using RDF (turtle):</p>
<div class="highlight"><pre><span class="err">...</span>
<span class="nc">wire:hasPlatformWiring</span> <span class="p">[</span> <span class="o">a</span> <span class="na">&lt;http://WireCloud.conwet.fi.upm.es/ns/widget#PlatformWiring&gt;</span><span class="p">;</span>
    <span class="nf">wire:hasInputEndpoint</span> <span class="p">[</span> <span class="o">a</span> <span class="na">&lt;http://wirecloud.conwet.fi.upm.es/ns/widget#InputEndpoint&gt;</span><span class="p">;</span>
        <span class="nf">rdfs:label</span> <span class="s">"Show forecast by coord"</span><span class="p">;</span>
        <span class="nf">dcterms:description</span> <span class="s">"Shows the weather forecast for a given location (a latitude longitude coordinate)."</span><span class="p">;</span>
        <span class="nf">dcterms:title</span> <span class="s">"coord"</span><span class="p">;</span>
        <span class="nf">wire:friendcode</span> <span class="s">"location"</span><span class="p">;</span>
        <span class="nf">wire:type</span> <span class="s">"text"</span> <span class="p">]</span> <span class="p">];</span>
<span class="p">.</span><span class="err">..</span>
</pre></div>
</div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            10/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Adding an input endpoint</h2>
</header>
<div class="contents"><p>Once declared the input endpoint in the widget template, you can register a
callback for this endpoint making use of the
<a href="https://wirecloud.readthedocs.org/en/latest/widgetapi/widgetapi/#mashupplatformwiringregistercallback-method"><code>MashupPlatform.wiring.registerCallback</code></a> method. In
addition to registering the input endpoint, we need to process event data before
using it and to notify the user that the forecast data for the given location is
being requested.</p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            11/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide has_code code-block">
<header class="slide-header">
<h2>Adding an input endpoint</h2>
</header>
<div class="contents"><p>This can be accomplished by using the following code:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">searchByCoordListener</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">searchByCoordListener</span><span class="p">(</span><span class="nx">event_data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">tmp</span><span class="p">,</span> <span class="nx">coord</span><span class="p">;</span>
    <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">event_data</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">','</span><span class="p">);</span>
    <span class="nx">coord</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">lat</span><span class="o">:</span> <span class="nx">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="nx">lon</span><span class="o">:</span> <span class="nx">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">};</span>
    <span class="nx">startLoadingAnimation</span><span class="p">();</span>
    <span class="nx">getForecastByCoord</span><span class="p">(</span><span class="nx">coord</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">forecast_data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">updateWeatherForecast</span><span class="p">(</span><span class="nx">forecast_data</span><span class="p">);</span>
        <span class="nx">stopLoadingAnimation</span><span class="p">();</span>
    <span class="p">},</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">clearWeatherForecast</span><span class="p">();</span>
        <span class="nx">stopLoadingAnimation</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">wiring</span><span class="p">.</span><span class="nx">registerCallback</span><span class="p">(</span><span class="s2">"coord"</span><span class="p">,</span> <span class="nx">searchByCoordListener</span><span class="p">);</span>
</pre></div>
</div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            12/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide section-title">
<header class="section-title-header">
<h1>Making requests and wiring</h1>
<h2><h2>Adding an output endpoint</h2></h2>
</header>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide has_code">
<header class="slide-header">
<h2>Adding an output endpoint</h2>
</header>
<div class="contents"><p>As we did with the input endpoint, we need to declare the new output endpoint in
the weather widget's description. This is the final result of the Wiring section
after adding it:</p>
<div class="highlight"><pre>...

<span class="nt">&lt;wiring&gt;</span>
    <span class="nt">&lt;inputendpoint</span> <span class="na">name=</span><span class="s">"coord"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">label=</span><span class="s">"Show forecast by coord"</span> <span class="na">description=</span><span class="s">"Shows the weather forecast for a given location (a latitude longitude coordinate)."</span> <span class="na">friendcode=</span><span class="s">"location"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;outputendpoint</span>
        <span class="na">name=</span><span class="s">"location_coord"</span>
        <span class="na">type=</span><span class="s">"text"</span>
        <span class="na">label=</span><span class="s">"Forecast location"</span>
        <span class="na">description=</span><span class="s">"This event is launched when the user clicks on the location name of current forecast."</span>
        <span class="na">friendcode=</span><span class="s">"location"</span>
    <span class="nt">/&gt;</span>
<span class="nt">&lt;/wiring&gt;</span>

...
</pre></div>
</div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            14/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Adding an output endpoint</h2>
</header>
<div class="contents"><h3>Output endpoint metadata</h3>
<ul>
<li>The <code>name</code> attribute will be use to reference to the output endpoint when
  using the javascript API</li>
<li>The <code>type</code> attribute defines the type of data this output endpoint is going to</li>
<li>generate, currently only "text" (string) is supported.</li>
<li>The <code>label</code> attribute will be used mainly in the Wiring Editor and will be
  the official name by which end users will know the output endpoint. Also, this
  attribute can be translated whereas the name attribute not</li>
<li>The <code>description</code> attribute is used to describe in which conditions the
  resource (in this case a widget) is going to send events through this
  endpoint. This description is also a good place for providing details about
  the data structure used by events leaving this output endpoint. This
  description is very important for the wiring process as the user needs this
  information for taking decisions on how to wire widgets and operators</li>
<li>The <code>friendcode</code> is used by the Wiring Editor to provide basic wiring
  recommendations. In this case, we are declaring that we send data aligned with
  the friendcode "location"</li>
</ul></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            15/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide has_code code-block">
<header class="slide-header">
<h2>Adding an output endpoint</h2>
</header>
<div class="contents"><p>This is how to declare the output endpoint when using RDF (turtle):</p>
<div class="highlight"><pre><span class="err">...</span>

<span class="nc">wire:hasPlatformWiring</span> <span class="p">[</span> <span class="o">a</span> <span class="na">&lt;http://wirecloud.conwet.fi.upm.es/ns/widget#PlatformWiring&gt;</span><span class="p">;</span>
        <span class="nf">wire:hasInputEndpoint</span> <span class="p">[</span> <span class="o">a</span> <span class="na">&lt;http://wirecloud.conwet.fi.upm.es/ns/widget#InputEndpoint&gt;</span><span class="p">;</span>
                <span class="nf">rdfs:label</span> <span class="s">"Show forecast by coord"</span><span class="p">;</span>
                <span class="nf">dcterms:description</span> <span class="s">"Shows the weather forecast for a given location (a latitude longitude coordinate)."</span><span class="p">;</span>
                <span class="nf">dcterms:title</span> <span class="s">"coord"</span><span class="p">;</span>
                <span class="nf">wire:friendcode</span> <span class="s">"location"</span><span class="p">;</span>
                <span class="nf">wire:type</span> <span class="s">"text"</span> <span class="p">]</span> <span class="p">];</span>
        <span class="nf">wire:hasOutputEndpoint</span> <span class="p">[</span> <span class="o">a</span> <span class="na">&lt;http://wirecloud.conwet.fi.upm.es/ns/widget#OutputEndpoint&gt;</span><span class="p">;</span>
                <span class="nf">rdfs:label</span> <span class="s">"Forecast location"</span><span class="p">;</span>
                <span class="nf">dcterms:description</span> <span class="s">"This event is launched when the user clicks on the location name of current forecast."</span><span class="p">;</span>
                <span class="nf">dcterms:title</span> <span class="s">"location_coord"</span><span class="p">;</span>
                <span class="nf">wire:friendcode</span> <span class="s">"location"</span><span class="p">;</span>
                <span class="nf">wire:type</span> <span class="s">"text"</span> <span class="p">];</span>

<span class="p">.</span><span class="err">..</span>
</pre></div>
</div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            16/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide has_code">
<header class="slide-header">
<h2>Adding an output endpoint</h2>
</header>
<div class="contents"><p>After adding the output endpoint to the widget description, we can send data
through it using the <a href="https://wirecloud.readthedocs.org/en/latest/widgetapi/widgetapi/#mashupplatformwiringpushevent-method"><code>MashupPlatform.wiring.pushEvent</code></a> method.
The following code adds an event listener to the location title that sends the
location of the current forecast:</p>
<div class="highlight"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'title'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="kr">long</span><span class="p">,</span> <span class="nx">lat</span><span class="p">;</span>

    <span class="kr">long</span> <span class="o">=</span> <span class="nx">forecast_data</span><span class="p">.</span><span class="nx">current_observation</span><span class="p">.</span><span class="nx">display_location</span><span class="p">.</span><span class="nx">longitude</span><span class="p">;</span>
    <span class="nx">lat</span> <span class="o">=</span> <span class="nx">forecast_data</span><span class="p">.</span><span class="nx">current_observation</span><span class="p">.</span><span class="nx">display_location</span><span class="p">.</span><span class="nx">latitude</span><span class="p">;</span>
    <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">wiring</span><span class="p">.</span><span class="nx">pushEvent</span><span class="p">(</span><span class="s1">'location_coord'</span><span class="p">,</span> <span class="kr">long</span> <span class="o">+</span> <span class="s1">','</span> <span class="o">+</span> <span class="nx">lat</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            17/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide section-title">
<header class="section-title-header">
<h1>Making requests and wiring</h1>
<h2><h2>Testing it</h2></h2>
</header>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Testing it</h2>
</header>
<div class="contents"><p>Now that we have implemented the weather widget we can make use of it to test it
is working as expected. One of the Widget that should be compatible with our
newly created weather widget is the "Web Map Service" Widget so a way to test
our widgets is to create a new Workspace with both widgets.</p>
<p>You can download Web Map Service widget from this <a href="attachments/CoNWeT_wms-viewer-geowidget_0.5.5.wgt">link</a>.</p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            19/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Testing it</h2>
</header>
<div class="contents"><p>Here is a screenshot of a workspace with both widgets:</p>
<p><img alt="Image can not be loaded." class="screenshot screenshot-sm" src="images/3.1.3_Testing it1.png"/></p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            20/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Testing it</h2>
</header>
<div class="contents"><p>And how to wire them:</p>
<p><img alt="Image can not be loaded." class="screenshot screenshot-sm" src="images/3.1.3_Testing it2.png"/></p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            21/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Testing it</h2>
</header>
<div class="contents"><p>Go back to your dashboard and click in any place of the map. Your weather widget
should be update and you should see something similiar to this:</p>
<p><img alt="Image can not be loaded." class="screenshot screenshot-sm" src="images/3.1.3_Testing it3.png"/></p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            22/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide">
<header class="slide-header">
<h2>Testing it</h2>
</header>
<div class="contents"><p>Also you should test that sending events from the widget is working correctly,
so move the map viewport to another part of the world and click on the location
title on the weather widget ("Horndon on the Hill, United kingdom" in the screenshot) so
visit other places using the Web Map Service Widget and click on the location
title to see if the Web Map Service goes back to the forecast location.</p>
<p>You can download both our implementation of the <a href="attachments/CoNWeT_weather-example_1.0.4.wgt">widget</a> as the <a href="attachments/CoNWeT_weather-mashup-example_1.0.1.wgt">mashup</a> example.</p></div>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<aside class="page_number">
                            23/24
                            </aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
<div class="slide-wrapper">
<section class="slide back-cover">
<div>Thanks!</div>
<img alt="Image can not be loaded." class="fiware-contact" src="fiwaretheme/images/FIWARE-contact.png"/>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE-full.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops-full.png"/>
<footer>
<aside class="source">Source: <a href="3.1.3_Making requests and wiring.md">3.1.3_Making requests and wiring.md</a></aside>
<img alt="Image can not be loaded." class="fiware-logo" src="fiwaretheme/images/FIWARE.png"/>
<img alt="Image can not be loaded." class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png"/>
</footer>
<div class="presenter_notes">
<header><h1>Presenter Notes</h1></header>
<section>
</section>
</div>
</section>
</div>
</div>
</div>
<div class="sidebar hidden" id="toc">
<h2>Table of Contents</h2>
<table>
<caption>Table of Contents</caption>
<tr id="toc-row-1">
<th><a href="#slide1">Making requests and wiring</a></th>
<td><a href="#slide1">1</a></td>
</tr>
<tr class="sub" id="toc-row-2">
<th><a href="#slide2">Introduction</a></th>
<td><a href="#slide2">2</a></td>
</tr>
<tr class="sub" id="toc-row-3">
<th><a href="#slide3">Introduction</a></th>
<td><a href="#slide3">3</a></td>
</tr>
<tr class="sub" id="toc-row-4">
<th><a href="#slide4">Making request to Weather Underground</a></th>
<td><a href="#slide4">4</a></td>
</tr>
<tr class="sub" id="toc-row-5">
<th><a href="#slide5">Making request to Weather Underground</a></th>
<td><a href="#slide5">5</a></td>
</tr>
<tr class="sub" id="toc-row-6">
<th><a href="#slide6">Making request to Weather Underground</a></th>
<td><a href="#slide6">6</a></td>
</tr>
<tr class="sub" id="toc-row-7">
<th><a href="#slide7">Adding an input endpoint</a></th>
<td><a href="#slide7">7</a></td>
</tr>
<tr class="sub" id="toc-row-8">
<th><a href="#slide8">Adding an input endpoint</a></th>
<td><a href="#slide8">8</a></td>
</tr>
<tr class="sub" id="toc-row-9">
<th><a href="#slide9">Adding an input endpoint</a></th>
<td><a href="#slide9">9</a></td>
</tr>
<tr class="sub" id="toc-row-10">
<th><a href="#slide10">Adding an input endpoint</a></th>
<td><a href="#slide10">10</a></td>
</tr>
<tr class="sub" id="toc-row-11">
<th><a href="#slide11">Adding an input endpoint</a></th>
<td><a href="#slide11">11</a></td>
</tr>
<tr class="sub" id="toc-row-12">
<th><a href="#slide12">Adding an input endpoint</a></th>
<td><a href="#slide12">12</a></td>
</tr>
<tr class="sub" id="toc-row-13">
<th><a href="#slide13">Adding an output endpoint</a></th>
<td><a href="#slide13">13</a></td>
</tr>
<tr class="sub" id="toc-row-14">
<th><a href="#slide14">Adding an output endpoint</a></th>
<td><a href="#slide14">14</a></td>
</tr>
<tr class="sub" id="toc-row-15">
<th><a href="#slide15">Adding an output endpoint</a></th>
<td><a href="#slide15">15</a></td>
</tr>
<tr class="sub" id="toc-row-16">
<th><a href="#slide16">Adding an output endpoint</a></th>
<td><a href="#slide16">16</a></td>
</tr>
<tr class="sub" id="toc-row-17">
<th><a href="#slide17">Adding an output endpoint</a></th>
<td><a href="#slide17">17</a></td>
</tr>
<tr class="sub" id="toc-row-18">
<th><a href="#slide18">Testing it</a></th>
<td><a href="#slide18">18</a></td>
</tr>
<tr class="sub" id="toc-row-19">
<th><a href="#slide19">Testing it</a></th>
<td><a href="#slide19">19</a></td>
</tr>
<tr class="sub" id="toc-row-20">
<th><a href="#slide20">Testing it</a></th>
<td><a href="#slide20">20</a></td>
</tr>
<tr class="sub" id="toc-row-21">
<th><a href="#slide21">Testing it</a></th>
<td><a href="#slide21">21</a></td>
</tr>
<tr class="sub" id="toc-row-22">
<th><a href="#slide22">Testing it</a></th>
<td><a href="#slide22">22</a></td>
</tr>
<tr class="sub" id="toc-row-23">
<th><a href="#slide23">Testing it</a></th>
<td><a href="#slide23">23</a></td>
</tr>
<tr id="toc-row-24">
<th><a href="#slide24">-</a></th>
<td><a href="#slide24">24</a></td>
</tr>
</table>
</div>
<div class="sidebar hidden" id="help">
<h2>Help</h2>
<table>
<caption>Help</caption>
<tr>
<th>Table of Contents</th>
<td>t</td>
</tr>
<tr>
<th>Exposé</th>
<td>ESC</td>
</tr>
<tr>
<th>Full screen slides</th>
<td>e</td>
</tr>
<tr>
<th>Presenter View</th>
<td>p</td>
</tr>
<tr>
<th>Source Files</th>
<td>s</td>
</tr>
<tr>
<th>Slide Numbers</th>
<td>n</td>
</tr>
<tr>
<th>Toggle screen blanking</th>
<td>b</td>
</tr>
<tr>
<th>Show/hide slide context</th>
<td>c</td>
</tr>
<tr>
<th>Notes</th>
<td>2</td>
</tr>
<tr>
<th>Help</th>
<td>h</td>
</tr>
</table>
</div>
<script>main()</script>
</body>
</html>