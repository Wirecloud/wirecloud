<!DOCTYPE html>
<!--
Copyright 2010 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Original slides: Marcin Wichary (mwichary@google.com)
Modifications: Ernest Delgado (ernestd@google.com)
Alex Russell (slightlyoff@chromium.org)

landslide modifications: Adam Zapletal (adamzap@gmail.com)
Nicolas Perriault (nperriault@gmail.com)
-->
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no" />
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>Using Orion Context Broker</title>
        <!-- Styles -->
        
        <link rel="stylesheet" media="print" href="./fiwaretheme/css/print.css">
        <link rel="stylesheet" media="screen, projection" href="./fiwaretheme/css/screen.css">
        
        
        <!-- /Styles -->
        <!-- Javascripts -->
        
        <script type="text/javascript" src="./fiwaretheme/js/slides.js"></script>
        
        
        <!-- /Javascripts -->
    </head>
    <body>
        <div id="blank"></div>
        <div class="presentation">
            <div id="current_presenter_notes">
                <div id="presenter_note"></div>
            </div>
            <div class="slides">
                
                <div class="slide-wrapper">
                    <section class="slide cover">
                        

                        <header class="slide-header"><h1>Using Orion Context Broker</h1><h2>Application Mashup (WireCloud) course @ https://fiware-academy.readthedocs.io/</h2></header>
                        <img class="fiware-contact" src="fiwaretheme/images/FIWARE-contact.png"/>
                        <img class="fiware-logo" src="fiwaretheme/images/FIWARE-full.png"/>
                        <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops-full.png"/>

                        <div class="navigation-tip">Use <kbd class="key">←</kbd> and <kbd class="key">→</kbd> to move around. Press <kbd class="key">h</kbd> for getting more info</div>
                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Using Orion Context Broker</h1>
                            <h2><h2>Introduction</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Introduction</h2>
                        </header>
                        
                        <div class="contents"><p>As part of the FIWARE work, WireCloud has integrated support for accessing
<a href="http://catalogue.fiware.org/enablers/publishsubscribe-context-broker-orion-context-broker">Orion Context Broker</a> (reference implementation of the FIWARE's Pub/Sub Context Broker
GE) instances from widgets/operators. In this tutorial we're going to learn how
to use this support.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            3/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Using Orion Context Broker</h1>
                            <h2><h2>Adding NGSI support to widgets and operators</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Adding NGSI support to widgets and operators</h2>
                        </header>
                        
                        <div class="contents"><p>First of all, widgets and operators wishing to use the JavaScript bindings
provided by WireCloud for accessing the FIWARE NGSI Open RESTful API in order to
seamlessly interoperate with the Orion Context Broker must add the NGSI feature
as a requirement into their description files (<code>config.xml</code> files).</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            5/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Adding NGSI support to widgets and operators</h2>
                        </header>
                        
                        <div class="contents"><h3>Using the XML description format</h3>
<p>The following is an example of a widget description using the XML flavour of the
Mashable Application Component Description Language:</p>
<div class="highlight"><pre><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
<span class="nt">&lt;widget</span> <span class="na">xmlns=</span><span class="s">&quot;http://wirecloud.conwet.fi.upm.es/ns/macdescription/1&quot;</span> <span class="na">vendor=</span><span class="s">&quot;CoNWeT&quot;</span> <span class="na">name=</span><span class="s">&quot;observation-reporter&quot;</span> <span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;details&gt;</span>
    <span class="nt">&lt;title&gt;</span>Observation Reporter<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;authors&gt;</span>aarranz<span class="nt">&lt;/authors&gt;</span>
    <span class="nt">&lt;email&gt;</span>aarranz@conwet.com<span class="nt">&lt;/email&gt;</span>
    <span class="nt">&lt;image&gt;</span>images/catalogue.png<span class="nt">&lt;/image&gt;</span>
    <span class="nt">&lt;smartphoneimage&gt;</span>images/smartphone.png<span class="nt">&lt;/smartphoneimage&gt;</span>
    <span class="nt">&lt;description&gt;</span>Creates a new observation<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;doc&gt;</span>http://www.envirofi.eu/<span class="nt">&lt;/doc&gt;</span>
  <span class="nt">&lt;/details&gt;</span>
  <span class="nt">&lt;requirements&gt;</span>
    <span class="nt">&lt;feature</span> <span class="na">name=</span><span class="s">&quot;NGSI&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/requirements&gt;</span>
  <span class="nt">&lt;wiring/&gt;</span>
  <span class="nt">&lt;contents</span> <span class="na">src=</span><span class="s">&quot;index.html&quot;</span> <span class="na">contenttype=</span><span class="s">&quot;text/html&quot;</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span> <span class="na">useplatformstyle=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;rendering</span> <span class="na">height=</span><span class="s">&quot;20&quot;</span> <span class="na">width=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/widget&gt;</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            6/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Adding NGSI support to widgets and operators</h2>
                        </header>
                        
                        <div class="contents"><h3>Using the RDF description format</h3>
<p>The RDF/xml flavour of the same widget description is:</p>
<div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;rdf:RDF</span>
  <span class="na">xmlns:foaf=</span><span class="s">&quot;http://xmlns.com/foaf/0.1/&quot;</span>
  <span class="na">xmlns:wire=</span><span class="s">&quot;http://wirecloud.conwet.fi.upm.es/ns/widget#&quot;</span>
  <span class="na">xmlns:rdfs=</span><span class="s">&quot;http://www.w3.org/2000/01/rdf-schema#&quot;</span>
  <span class="na">xmlns:usdl=</span><span class="s">&quot;http://www.linked-usdl.org/ns/usdl-core#&quot;</span>
  <span class="na">xmlns:rdf=</span><span class="s">&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
  <span class="na">xmlns:ns1=</span><span class="s">&quot;http://purl.org/goodrelations/v1#&quot;</span>
  <span class="na">xmlns:dcterms=</span><span class="s">&quot;http://purl.org/dc/terms/&quot;</span>
  <span class="na">xmlns:vcard=</span><span class="s">&quot;http://www.w3.org/2006/vcard/ns#&quot;</span>
<span class="nt">&gt;</span>
  <span class="nt">&lt;wire:Widget</span> <span class="na">rdf:about=</span><span class="s">&quot;http://wirecloud.conwet.fi.upm.es/ns/widget#CoNWeT/observation-reporter/1.0&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;vcard:addr&gt;</span>
      <span class="nt">&lt;vcard:Work</span> <span class="na">rdf:nodeID=</span><span class="s">&quot;Nb17ce611aa2645e488515f86eb855e53&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;vcard:email&gt;</span>aarranz@conwet.com<span class="nt">&lt;/vcard:email&gt;</span>
      <span class="nt">&lt;/vcard:Work&gt;</span>
    <span class="nt">&lt;/vcard:addr&gt;</span>
    <span class="nt">&lt;usdl:utilizedResource&gt;</span>
      <span class="nt">&lt;usdl:Resource</span> <span class="na">rdf:about=</span><span class="s">&quot;index.html&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;wire:codeCacheable&gt;</span>True<span class="nt">&lt;/wire:codeCacheable&gt;</span>
      <span class="nt">&lt;/usdl:Resource&gt;</span>
    <span class="nt">&lt;/usdl:utilizedResource&gt;</span>
    <span class="nt">&lt;wire:hasPlatformWiring&gt;</span>
      <span class="nt">&lt;wire:PlatformWiring</span> <span class="na">rdf:nodeID=</span><span class="s">&quot;Neecb97db81ed40859b8c04e935a9a9cc&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/wire:hasPlatformWiring&gt;</span>
    <span class="nt">&lt;wire:displayName&gt;</span>Observation Reporter<span class="nt">&lt;/wire:displayName&gt;</span>
    <span class="nt">&lt;wire:hasiPhoneImageUri</span> <span class="na">rdf:resource=</span><span class="s">&quot;images/smartphone.png&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;usdl:versionInfo&gt;</span>1.0<span class="nt">&lt;/usdl:versionInfo&gt;</span>
    <span class="nt">&lt;usdl:hasProvider&gt;</span>
      <span class="nt">&lt;ns1:BusinessEntity</span> <span class="na">rdf:nodeID=</span><span class="s">&quot;N9a6bf56577c741ac806997a80281afff&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;foaf:name&gt;</span>CoNWeT<span class="nt">&lt;/foaf:name&gt;</span>
      <span class="nt">&lt;/ns1:BusinessEntity&gt;</span>
    <span class="nt">&lt;/usdl:hasProvider&gt;</span>
    <span class="nt">&lt;wire:hasImageUri</span> <span class="na">rdf:resource=</span><span class="s">&quot;images/catalogue.png&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;wire:hasPlatformRendering&gt;</span>
      <span class="nt">&lt;wire:PlatformRendering</span> <span class="na">rdf:nodeID=</span><span class="s">&quot;N713e5ea11dce4750a592c754c748def7&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;wire:renderingHeight&gt;</span>20<span class="nt">&lt;/wire:renderingHeight&gt;</span>
        <span class="nt">&lt;wire:renderingWidth&gt;</span>5<span class="nt">&lt;/wire:renderingWidth&gt;</span>
      <span class="nt">&lt;/wire:PlatformRendering&gt;</span>
    <span class="nt">&lt;/wire:hasPlatformRendering&gt;</span>
    <span class="nt">&lt;wire:hasRequirement&gt;</span>
      <span class="nt">&lt;wire:Feature</span> <span class="na">rdf:nodeID=</span><span class="s">&quot;N3cb336bd9b6243ecbf345c80442498f9&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;rdfs:label&gt;</span>NGSI<span class="nt">&lt;/rdfs:label&gt;</span>
      <span class="nt">&lt;/wire:Feature&gt;</span>
    <span class="nt">&lt;/wire:hasRequirement&gt;</span>
    <span class="nt">&lt;dcterms:title&gt;</span>observation-reporter<span class="nt">&lt;/dcterms:title&gt;</span>
    <span class="nt">&lt;dcterms:description&gt;</span>Creates a new observation<span class="nt">&lt;/dcterms:description&gt;</span>
    <span class="nt">&lt;dcterms:creator&gt;</span>
      <span class="nt">&lt;foaf:Person</span> <span class="na">rdf:nodeID=</span><span class="s">&quot;Ndb72cb5a7f3844b29b72f304baaa14a7&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;foaf:name&gt;</span>aarranz<span class="nt">&lt;/foaf:name&gt;</span>
      <span class="nt">&lt;/foaf:Person&gt;</span>
    <span class="nt">&lt;/dcterms:creator&gt;</span>
  <span class="nt">&lt;/wire:Widget&gt;</span>
<span class="nt">&lt;/rdf:RDF&gt;</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            7/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Using Orion Context Broker</h1>
                            <h2><h2>Creating connections to NGSI Context Brokers</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Creating connections to NGSI Context Brokers</h2>
                        </header>
                        
                        <div class="contents"><p>Before being able to make use of the NGSI API, you should create a Connection
with the NGSI Context Broker you're going to use. This can be accomplished with
the following code:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">ngsi_connection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NGSI</span><span class="p">.</span><span class="nx">Connection</span><span class="p">(</span><span class="nx">ngsi_server</span><span class="p">[,</span> <span class="nx">options</span><span class="p">]);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            9/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Creating connections to NGSI Context Brokers</h2>
                        </header>
                        
                        <div class="contents"><p>See the <a href="https://wirecloud.readthedocs.org/en/latest/development/ngsi_api/#ngsiconnection">NGSI javascript API documentation</a> for the full list of supported options
but, as summary, the <code>ngsi_proxy_url</code> option is required for being able to create
subscriptions handled by widgets/operators. Also, if you are connecting to a
Orion Context Broker using the IdM authentication, you will need to pass the
required authentication credentials. This can be accomplished in two ways:</p>
<ul>
<li>Making use of the <code>request_headers</code> option and passing directly the required
  Authentication header</li>
<li>Making use of the <code>use_user_fiware_token</code> option to make the the NGSI API user
  the FIWARE's OAuth2 token of the current user (obtained by WireCloud from the
  IdM). Any request made by a connection using this option will fail if the
  current users doesn't have a valid token (take into account that anonymous
  users and users authenticated using other authentication backends fall into
  this category). If you're worried about security, take into account that the
  OAuth2 token is injected in the request by the WireCloud's proxy</li>
</ul></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            10/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Creating connections to NGSI Context Brokers</h2>
                        </header>
                        
                        <div class="contents"><p>This is an example of NGSI connection creation using the resources available at FIWARE Lab:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">ngsi_connection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NGSI</span><span class="p">.</span><span class="nx">Connection</span><span class="p">(</span><span class="s1">&#39;http://orion.lab.fiware.org:1026&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">use_user_fiware_token</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">ngsi_proxy_url</span><span class="o">:</span> <span class="s1">&#39;https://ngsiproxy.lab.fiware.org&#39;</span>
<span class="p">});</span>
</pre></div>

<p>Once created the connection, you will be able to use the NGSI API bindings (in
the example, through the <code>ngsi_connection</code> variable).</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            11/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Using Orion Context Broker</h1>
                            <h2><h2>Making queries</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><p>Queries are the most basic operations that can be executed in a Orion Context
Broker. This operation can be accessed thought the query method of the
connection object:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">entityIdList</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;Van&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;.*&#39;</span><span class="p">,</span> <span class="nx">isPattern</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
<span class="p">];</span>
<span class="kd">var</span> <span class="nx">attributeList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;current_position&#39;</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">flat</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// data contains the obtained info</span>
        <span class="c1">// from the context broker</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">entityIdList</span><span class="p">,</span> <span class="nx">attributeList</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            13/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><p>The first parameter is the list of entities you're interested on. In our case,
we're interested in all <code>Van</code> entities. This is accomplished using the <code>isPattern</code>
option that allows us to use a regular expression that matches with any <code>id</code>.</p>
<p>The second one is the list of attributes you're interested on. In our case,
we're interested only in the <code>current_position</code> attribute. However, you can
pass null or an empty list to indicate that you are interested in all the
attributes of the selected entities.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            14/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><p>Finally, all the methods supports a last parameter called options that should be
used to pass the callbacks and the extra options. Any method of NGSI.Connection
support at least the following callbacks:</p>
<ul>
<li><code>onSuccess</code> is called when the request finishes successfully. The parameters passed to this callback depends on the invoked method. In the case of the query operation, the first parameter will contain the data returned after querying the context broker</li>
<li><code>onFailure</code> is called when the request finish with errors</li>
<li><code>onComplete</code> is called when the request finish regardless of whether the request is successful or not</li>
</ul></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            15/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><p>The <code>query</code> method also supports other extra options. The <code>flat</code> options is used for simplifying the data structure used for representing the returned data. This simplification relies in making the following assumptions about the returned entry set:</p>
<ul>
<li>given an entity <code>id</code> there is only one value for the entity's type parameter</li>
<li>entities doesn't have attributes called <code>id</code> or <code>type</code></li>
<li>entities have only an attribute with a given <code>name</code></li>
<li>attribute types don't matter or are already known</li>
<li>attribute metadata don't matter or is already known</li>
</ul></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            16/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><p>For example, this is the value of the data parameter passed to the <code>onSuccess</code> callback when using the <code>flat</code> option:</p>
<div class="highlight"><pre> <span class="p">{</span>
    <span class="s2">&quot;van1&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span><span class="p">,</span>
        <span class="s2">&quot;current_position&quot;</span><span class="o">:</span> <span class="s2">&quot;43.47557, -3.8048315&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;van2&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span><span class="p">,</span>
        <span class="s2">&quot;current_position&quot;</span><span class="o">:</span> <span class="s2">&quot;43.47258, -3.8026643&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;van3&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span><span class="p">,</span>
        <span class="s2">&quot;current_position&quot;</span><span class="o">:</span> <span class="s2">&quot;43.47866, -3.7991238&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;van4&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span><span class="p">,</span>
        <span class="s2">&quot;current_position&quot;</span><span class="o">:</span> <span class="s2">&quot;43.471214, -3.7994885&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            17/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><p>Whereas this is the value of the data parameter when <code>flat</code> is <code>false</code> <strong>(default value)</strong>:</p>
<div class="highlight"><pre> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;entity&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;current_position&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contextValue&quot;</span><span class="o">:</span> <span class="s2">&quot;43.47557, -3.8048315&quot;</span><span class="p">,</span>
                <span class="s2">&quot;metadata&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;WGS84&#39;</span><span class="p">}]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;entity&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;current_position&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contextValue&quot;</span><span class="o">:</span> <span class="s2">&quot;43.47258, -3.8026643&quot;</span><span class="p">,</span>
                <span class="s2">&quot;metadata&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;WGS84&#39;</span><span class="p">}]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;entity&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;current_position&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contextValue&quot;</span><span class="o">:</span> <span class="s2">&quot;43.47866, -3.7991238&quot;</span><span class="p">,</span>
                <span class="s2">&quot;metadata&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;WGS84&#39;</span><span class="p">}]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;entity&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;current_position&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contextValue&quot;</span><span class="o">:</span> <span class="s2">&quot;43.471214, -3.7994885&quot;</span><span class="p">,</span>
                <span class="s2">&quot;metadata&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;WGS84&#39;</span><span class="p">}]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            18/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><h3>Pagination</h3>
<p>In addition to the <code>flat</code> option. The <code>query</code> method also support other options
related to the pagination support found on Orion 0.14.0 and newer. These options
are the <code>limit</code>, <code>offset</code> and <code>details</code> options. For example, the following code can
be used for retrieving a first page containing (at most) 100 entities:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">flat</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">limit</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">....</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">entityIdList</span><span class="p">,</span> <span class="nx">attributeList</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            19/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><h3>Pagination</h3>
<p>While this code will request the second page:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">flat</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">limit</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nx">offset</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">....</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">entityIdList</span><span class="p">,</span> <span class="nx">attributeList</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            20/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Making queries</h2>
                        </header>
                        
                        <div class="contents"><h3>Pagination</h3>
<p>You can get the total number of matches using the <code>details</code> option:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">flat</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">limit</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nx">offset</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="nx">details</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">details</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// The total number of matches is stored in details.count</span>
        <span class="p">....</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">entityIdList</span><span class="p">,</span> <span class="nx">attributeList</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            21/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Using Orion Context Broker</h1>
                            <h2><h2>Creating subscriptions</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Creating subscriptions</h2>
                        </header>
                        
                        <div class="contents"><p>One of the most important operations provided by the context broker is the
support for creating subscriptions, in this way our system can obtain "real
time" notifications about the status of the entities of our system.
Subscriptions are very similar to queries, the main difference between queries
and subscriptions is that queries are synchronous operations. Moreover, the
Orion Context Broker will send a first notification containing the data that
would be returned for the equivalent query operation. This way, you will know
that there is no gap between the current values and their notified changes.</p>
<p>Both widgets and operators can create subscriptions through the
<a href="https://wirecloud.readthedocs.org/en/latest/development/ngsi_api/#createsubscription"><code>createSubscription</code></a> method.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            23/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Creating subscriptions</h2>
                        </header>
                        
                        <div class="contents"><p>The following example explains how to be notified about the changes of the position of the vans:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">entityIdList</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;Van&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;.*&#39;</span><span class="p">,</span> <span class="nx">isPattern</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
<span class="p">];</span>
<span class="kd">var</span> <span class="nx">attributeList</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">duration</span> <span class="o">=</span> <span class="s1">&#39;PT3H&#39;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">throttling</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">notifyConditions</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;ONCHANGE&#39;</span><span class="p">,</span>
    <span class="nx">condValues</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;current_position&#39;</span><span class="p">]</span>
<span class="p">}];</span>
<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">flat</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">onNotify</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// called when the context broker sends a new notification</span>
    <span class="p">},</span>
    <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ngsi_subscriptionId</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">subscriptionId</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">createSubscription</span><span class="p">(</span><span class="nx">entityIdList</span><span class="p">,</span> <span class="nx">attributeList</span><span class="p">,</span> <span class="nx">duration</span><span class="p">,</span> <span class="nx">throttling</span><span class="p">,</span> <span class="nx">notifyConditions</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            24/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Creating subscriptions</h2>
                        </header>
                        
                        <div class="contents"><p>In the previous example, this call to <code>createSubscription</code> will make the context broker
call the <code>onNotify</code> function each time the <code>current_position</code> attribute of the
entities of type <code>Van</code> is changed. You must take into account that the Orion
Context Broker evaluates patterns at runtime, so using patterns you will be able
to receive notification about new entities provided that the notify conditions
are meet.</p>
<p>This subscription will expire after 3 hours, time from which the context broker
will stop sending notifications. Anyway, widgets/operators can renew those
subscriptions by using the <a href="https://wirecloud.readthedocs.org/en/latest/development/ngsi_api/#updatesubscription">updateSubscription</a> method, even if they have
expired. Subscriptions can be cancelled using the <a href="https://wirecloud.readthedocs.org/en/latest/development/ngsi_api/#cancelsubscription">cancelSubscription</a> method
making the context broker release any info about the subscription. In any case,
WireCloud will cancel any subscription automatically when widgets/operators are
unloaded.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            25/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Creating subscriptions</h2>
                        </header>
                        
                        <div class="contents"><p>As with the query operations, you can make use of the <code>flat</code> option when creating
subscriptions. The assumptions made by the <code>createSubscription</code> method will be the
same that the ones used by the <code>query</code> method, the only thing that changes is that
this affects to the parameter passed to the notification callback instead to the
success callback.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            26/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code code-block">
                        

                        
                        <header class="slide-header">
                            <h2>Creating subscriptions</h2>
                        </header>
                        
                        <div class="contents"><p>As example, this is the value of the data parameter passed to
the <code>onNotify</code> callback when using the <code>flat</code> option:</p>
<div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;elements&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;van2&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span><span class="p">,</span>
            <span class="s2">&quot;current_position&quot;</span><span class="o">:</span> <span class="s2">&quot;43.47258, -3.8026643&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;van4&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span><span class="p">,</span>
            <span class="s2">&quot;current_position&quot;</span><span class="o">:</span> <span class="s2">&quot;43.471214, -3.7994885&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;subscriptionId&quot;</span><span class="o">:</span> <span class="s2">&quot;53708768286043030c116e2c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;originator&quot;</span><span class="o">:</span> <span class="s2">&quot;localhost&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            27/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Creating subscriptions</h2>
                        </header>
                        
                        <div class="contents"><p>Whereas this is the value of the data parameter when <code>flat</code> is <code>false</code> <strong>(default value)</strong>:</p>
<div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;elements&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;entity&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;current_position&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;contextValue&quot;</span><span class="o">:</span> <span class="s2">&quot;43.47258, -3.8026643&quot;</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;entity&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;van4&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Van&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;current_position&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;contextValue&quot;</span><span class="o">:</span> <span class="s2">&quot;43.471214, -3.7994885&quot;</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;subscriptionId&quot;</span><span class="o">:</span> <span class="s2">&quot;53708768286043030c116e2c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;originator&quot;</span><span class="o">:</span> <span class="s2">&quot;localhost&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            28/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Using Orion Context Broker</h1>
                            <h2><h2>Creating entities and updating their attributes</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Creating entities and updating their attributes</h2>
                        </header>
                        
                        <div class="contents"><p>Widgets and operator can update entities using the
<a href="3.3.2_NGSI API#slide25"><code>updateAttributes</code></a> and <a href="3.3.2_NGSI
API#slide27"><code>addAttributes</code></a> methods. The <code>updateAttributes</code> and <code>addAttributes</code> methods use the
same format for their parameters, the main difference is that <code>addAttribute</code>
method will create new attributes/entities if needed whereas <code>updateAttributes</code>
will fail if the referred entities/attributes didn't exist.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            30/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Creating entities and updating their attributes</h2>
                        </header>
                        
                        <div class="contents"><p>For example, the following code updates the attribute <code>position</code> of the <code>van1</code> entity if it
exists, or creates the attribute or the entity if one of them don't exist:</p>
<div class="highlight"><pre><span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">addAttributes</span><span class="p">([{</span>
        <span class="nx">entity</span><span class="o">:</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;van1&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;Van&#39;</span><span class="p">},</span>
        <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
                <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;current_position&#39;</span><span class="p">,</span>
                <span class="nx">contextValue</span><span class="o">:</span> <span class="nx">coordinates</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}],</span> <span class="p">{</span>
        <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">accepted_changes</span><span class="p">,</span> <span class="nx">unaccepted_changes</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// The Orion Context Broker processed the request successfully</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">unaccepted_changes</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Van created/updated successfully</span>
                <span class="p">...</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Something went wrong</span>
            <span class="p">}</span>
        <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span>
        <span class="nx">onFailure</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// General failure when creating/updating the van</span>
        <span class="p">},</span>
        <span class="nx">onComplete</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">//</span>
        <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            31/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Creating entities and updating their attributes</h2>
                        </header>
                        
                        <div class="contents"><p>The <code>response_data</code> parameter of the <code>onSuccess</code> callback is a summary of the
accepted changes as returned by the Orion Context Broker. This info can normally
be ignored, as it will be very similar to the one provided to the
<code>updateAttributes</code>/<code>addAttribute</code> methods when the request ends successfully. If
everything goes ok, the <code>unaccepted_changes</code> parameter will contain an empty
array. If something goes wrong, the <code>unaccepted_changes</code> parameter will contain
all the info about what changes were rejected. It's very important to take this
into account as the <code>onFailure</code> callback won't be called for reporting unaccepted
changes as they are treated individually by the Orion Context Broker.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            32/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code code-block">
                        

                        
                        <header class="slide-header">
                            <h2>Creating entities and updating their attributes</h2>
                        </header>
                        
                        <div class="contents"><p>For example, if we execute the following code:</p>
<div class="highlight"><pre><span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">updateAttributes</span><span class="p">([</span>
        <span class="p">{</span>
            <span class="s1">&#39;entity&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">},</span>
            <span class="s1">&#39;attributes&#39;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;coords&#39;</span><span class="p">,</span> <span class="nx">contextValue</span><span class="o">:</span> <span class="s1">&#39;40.418889, -3.691944&#39;</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;entity&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;Point&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;A&#39;</span><span class="p">},</span>
            <span class="s1">&#39;attributes&#39;</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;mobile_phone&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">contextValue</span><span class="o">:</span> <span class="s1">&#39;0034223456789&#39;</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="p">...</span>
    <span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            33/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Creating entities and updating their attributes</h2>
                        </header>
                        
                        <div class="contents"><p>Giving the fact both Madrid and A entities exit but only the position attribute
exists, the value of the <code>accepted_changes</code> will be:</p>
<div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span>
        <span class="nx">entity</span><span class="o">:</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;City&#39;</span><span class="p">},</span>
        <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;coords&#39;</span><span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            34/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Creating entities and updating their attributes</h2>
                        </header>
                        
                        <div class="contents"><p>Whereas the value of the <code>unaccepted_changes</code> parameters will be something similar to this:</p>
<div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span>
        <span class="nx">entity</span><span class="o">:</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;Point&#39;</span><span class="p">},</span>
        <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;mobile_phone&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">statusCode</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">code</span><span class="o">:</span> <span class="mi">472</span><span class="p">,</span>
            <span class="nx">reasonPhrase</span><span class="o">:</span> <span class="s1">&#39;request parameter is invalid/not allowed&#39;</span><span class="p">,</span>
            <span class="nx">details</span> <span class="o">:</span> <span class="s1">&#39;action: UPDATE - entity: (A, Point) - offending attribute: mobile_phone&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            35/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Using Orion Context Broker</h1>
                            <h2><h2>Using Orion's geolocation capabilities</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code code-block">
                        

                        
                        <header class="slide-header">
                            <h2>Using Orion's geolocation capabilities</h2>
                        </header>
                        
                        <div class="contents"><p>The following code snippet shows an example of how to create a position
attribute indicating that it will be used for defining the location of the
entity:</p>
<div class="highlight"><pre><span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">addAttributes</span><span class="p">([</span>
        <span class="p">{</span>
            <span class="nx">entity</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">},</span>
            <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;coords&#39;</span><span class="p">,</span>
                    <span class="nx">contextValue</span><span class="o">:</span> <span class="s1">&#39;40.418889, -3.691944&#39;</span><span class="p">,</span>
                    <span class="nx">metadata</span><span class="o">:</span> <span class="p">[</span>
                        <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;WGS84&#39;</span><span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="p">...</span>
    <span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            37/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Using Orion's geolocation capabilities</h2>
                        </header>
                        
                        <div class="contents"><p>After which you can issue geo-located queries. For example:</p>
<div class="highlight"><pre><span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">([</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;.*&#39;</span><span class="p">,</span> <span class="nx">isPattern</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="kc">null</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="nx">restriction</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">scopes</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;FIWARE_Location&quot;</span><span class="p">,</span>
                    <span class="nx">value</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">circle</span><span class="o">:</span> <span class="p">{</span>
                            <span class="nx">centerLatitude</span><span class="o">:</span> <span class="s2">&quot;40.418889&quot;</span><span class="p">,</span>
                            <span class="nx">centerLongitude</span><span class="o">:</span> <span class="s2">&quot;-3.691944&quot;</span><span class="p">,</span>
                            <span class="nx">radius</span><span class="o">:</span> <span class="s2">&quot;14000&quot;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">...</span>
     <span class="p">});</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            38/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Using Orion's geolocation capabilities</h2>
                        </header>
                        
                        <div class="contents"><p>Or:</p>
<div class="highlight"><pre><span class="nx">connection</span><span class="p">.</span><span class="nx">query</span><span class="p">([</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;Point&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;.*&#39;</span><span class="p">,</span> <span class="nx">isPattern</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="kc">null</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="nx">restriction</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">scopes</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="nx">type</span> <span class="o">:</span> <span class="s2">&quot;FIWARE_Location&quot;</span><span class="p">,</span>
                    <span class="nx">value</span> <span class="o">:</span> <span class="p">{</span>
                        <span class="nx">polygon</span><span class="o">:</span> <span class="p">{</span>
                            <span class="nx">vertices</span><span class="o">:</span> <span class="p">[</span>
                                <span class="p">{</span> <span class="nx">latitude</span><span class="o">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="nx">longitude</span><span class="o">:</span> <span class="s2">&quot;0&quot;</span> <span class="p">},</span>
                                <span class="p">{</span> <span class="nx">latitude</span><span class="o">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="nx">longitude</span><span class="o">:</span> <span class="s2">&quot;6&quot;</span> <span class="p">},</span>
                                <span class="p">{</span> <span class="nx">latitude</span><span class="o">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="nx">longitude</span><span class="o">:</span> <span class="s2">&quot;0&quot;</span> <span class="p">}</span>
                            <span class="p">],</span>
                            <span class="nx">inverted</span><span class="o">:</span> <span class="kc">true</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">...</span>
    <span class="p">});</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            39/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Using Orion Context Broker</h1>
                            <h2><h2>A Real Example</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>A Real Example</h2>
                        </header>
                        
                        <div class="contents"><p>To check how NGSI works, an example using this feature is provided. If you want
to see it running you have to upload the following mashup into WireCloud:</p>
<ul>
<li><a href="attachments/CoNWeT_NGSI Example_1.0.wgt">NGSI Example Mashup</a></li>
</ul>
<p>This mashup uses the following components:</p>
<ul>
<li><a href="attachments/CoNWeT_ngsi-source_3.0.2.wgt">NGSI Source</a></li>
<li><a href="attachments/CoNWeT_ngsientity2poi_3.0.3.wgt">NGSI Entity2POI</a></li>
<li><a href="attachments/CoNWeT_map-viewer_2.5.3.wgt">Map Viewer</a></li>
</ul>
<p>Once uploaded, you will be able to create new workspaces using this mashup as
template. Take into account that this example is meant to work on <a href="https://mashup.lab.fiware.org">FIWARE
Lab</a>.</p>
<p>Another source of examples is the <a href="https://store.lab.fiware.org/search/keyword/OrionStarterKit">OrionStarterKit</a> offering
available at the FIWARE Lab's Store containing all the generic widgets and
operators related to the Orion Context Broker and several example mashups.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            41/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>A Real Example</h2>
                        </header>
                        
                        <div class="contents"><p>If everything is ok, you will see a map as the following one, with the location
of some lampposts in the city of Santander.</p>
<p><img class="screenshot screenshot-sm" src="images/3.2.1_Testing it.png"/></p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            <aside class="page_number">
                            42/43
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide back-cover">
                        
                        <div>Thanks!</div>
                        <img class="fiware-contact" src="fiwaretheme/images/FIWARE-contact.png"/>
                        <img class="fiware-logo" src="fiwaretheme/images/FIWARE-full.png"/>
                        <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops-full.png"/>
                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.2.1_Using Orion Context Broker.md">3.2.1_Using Orion Context Broker.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
            </div>
        </div>
        
        <div id="toc" class="sidebar hidden">
            <h2>Table of Contents</h2>
            <table>
                <caption>Table of Contents</caption>
                
                <tr id="toc-row-1">
                    <th><a href="#slide1">Using Orion Context Broker</a></th>
                    <td><a href="#slide1">1</a></td>
                </tr>
                
                
                <tr id="toc-row-2" class="sub">
                    <th><a href="#slide2">Introduction</a></th>
                    <td><a href="#slide2">2</a></td>
                </tr>
                
                <tr id="toc-row-3" class="sub">
                    <th><a href="#slide3">Introduction</a></th>
                    <td><a href="#slide3">3</a></td>
                </tr>
                
                <tr id="toc-row-4" class="sub">
                    <th><a href="#slide4">Adding NGSI support to widgets and operators</a></th>
                    <td><a href="#slide4">4</a></td>
                </tr>
                
                <tr id="toc-row-5" class="sub">
                    <th><a href="#slide5">Adding NGSI support to widgets and operators</a></th>
                    <td><a href="#slide5">5</a></td>
                </tr>
                
                <tr id="toc-row-6" class="sub">
                    <th><a href="#slide6">Adding NGSI support to widgets and operators</a></th>
                    <td><a href="#slide6">6</a></td>
                </tr>
                
                <tr id="toc-row-7" class="sub">
                    <th><a href="#slide7">Adding NGSI support to widgets and operators</a></th>
                    <td><a href="#slide7">7</a></td>
                </tr>
                
                <tr id="toc-row-8" class="sub">
                    <th><a href="#slide8">Creating connections to NGSI Context Brokers</a></th>
                    <td><a href="#slide8">8</a></td>
                </tr>
                
                <tr id="toc-row-9" class="sub">
                    <th><a href="#slide9">Creating connections to NGSI Context Brokers</a></th>
                    <td><a href="#slide9">9</a></td>
                </tr>
                
                <tr id="toc-row-10" class="sub">
                    <th><a href="#slide10">Creating connections to NGSI Context Brokers</a></th>
                    <td><a href="#slide10">10</a></td>
                </tr>
                
                <tr id="toc-row-11" class="sub">
                    <th><a href="#slide11">Creating connections to NGSI Context Brokers</a></th>
                    <td><a href="#slide11">11</a></td>
                </tr>
                
                <tr id="toc-row-12" class="sub">
                    <th><a href="#slide12">Making queries</a></th>
                    <td><a href="#slide12">12</a></td>
                </tr>
                
                <tr id="toc-row-13" class="sub">
                    <th><a href="#slide13">Making queries</a></th>
                    <td><a href="#slide13">13</a></td>
                </tr>
                
                <tr id="toc-row-14" class="sub">
                    <th><a href="#slide14">Making queries</a></th>
                    <td><a href="#slide14">14</a></td>
                </tr>
                
                <tr id="toc-row-15" class="sub">
                    <th><a href="#slide15">Making queries</a></th>
                    <td><a href="#slide15">15</a></td>
                </tr>
                
                <tr id="toc-row-16" class="sub">
                    <th><a href="#slide16">Making queries</a></th>
                    <td><a href="#slide16">16</a></td>
                </tr>
                
                <tr id="toc-row-17" class="sub">
                    <th><a href="#slide17">Making queries</a></th>
                    <td><a href="#slide17">17</a></td>
                </tr>
                
                <tr id="toc-row-18" class="sub">
                    <th><a href="#slide18">Making queries</a></th>
                    <td><a href="#slide18">18</a></td>
                </tr>
                
                <tr id="toc-row-19" class="sub">
                    <th><a href="#slide19">Making queries</a></th>
                    <td><a href="#slide19">19</a></td>
                </tr>
                
                <tr id="toc-row-20" class="sub">
                    <th><a href="#slide20">Making queries</a></th>
                    <td><a href="#slide20">20</a></td>
                </tr>
                
                <tr id="toc-row-21" class="sub">
                    <th><a href="#slide21">Making queries</a></th>
                    <td><a href="#slide21">21</a></td>
                </tr>
                
                <tr id="toc-row-22" class="sub">
                    <th><a href="#slide22">Creating subscriptions</a></th>
                    <td><a href="#slide22">22</a></td>
                </tr>
                
                <tr id="toc-row-23" class="sub">
                    <th><a href="#slide23">Creating subscriptions</a></th>
                    <td><a href="#slide23">23</a></td>
                </tr>
                
                <tr id="toc-row-24" class="sub">
                    <th><a href="#slide24">Creating subscriptions</a></th>
                    <td><a href="#slide24">24</a></td>
                </tr>
                
                <tr id="toc-row-25" class="sub">
                    <th><a href="#slide25">Creating subscriptions</a></th>
                    <td><a href="#slide25">25</a></td>
                </tr>
                
                <tr id="toc-row-26" class="sub">
                    <th><a href="#slide26">Creating subscriptions</a></th>
                    <td><a href="#slide26">26</a></td>
                </tr>
                
                <tr id="toc-row-27" class="sub">
                    <th><a href="#slide27">Creating subscriptions</a></th>
                    <td><a href="#slide27">27</a></td>
                </tr>
                
                <tr id="toc-row-28" class="sub">
                    <th><a href="#slide28">Creating subscriptions</a></th>
                    <td><a href="#slide28">28</a></td>
                </tr>
                
                <tr id="toc-row-29" class="sub">
                    <th><a href="#slide29">Creating entities and updating their attributes</a></th>
                    <td><a href="#slide29">29</a></td>
                </tr>
                
                <tr id="toc-row-30" class="sub">
                    <th><a href="#slide30">Creating entities and updating their attributes</a></th>
                    <td><a href="#slide30">30</a></td>
                </tr>
                
                <tr id="toc-row-31" class="sub">
                    <th><a href="#slide31">Creating entities and updating their attributes</a></th>
                    <td><a href="#slide31">31</a></td>
                </tr>
                
                <tr id="toc-row-32" class="sub">
                    <th><a href="#slide32">Creating entities and updating their attributes</a></th>
                    <td><a href="#slide32">32</a></td>
                </tr>
                
                <tr id="toc-row-33" class="sub">
                    <th><a href="#slide33">Creating entities and updating their attributes</a></th>
                    <td><a href="#slide33">33</a></td>
                </tr>
                
                <tr id="toc-row-34" class="sub">
                    <th><a href="#slide34">Creating entities and updating their attributes</a></th>
                    <td><a href="#slide34">34</a></td>
                </tr>
                
                <tr id="toc-row-35" class="sub">
                    <th><a href="#slide35">Creating entities and updating their attributes</a></th>
                    <td><a href="#slide35">35</a></td>
                </tr>
                
                <tr id="toc-row-36" class="sub">
                    <th><a href="#slide36">Using Orion's geolocation capabilities</a></th>
                    <td><a href="#slide36">36</a></td>
                </tr>
                
                <tr id="toc-row-37" class="sub">
                    <th><a href="#slide37">Using Orion's geolocation capabilities</a></th>
                    <td><a href="#slide37">37</a></td>
                </tr>
                
                <tr id="toc-row-38" class="sub">
                    <th><a href="#slide38">Using Orion's geolocation capabilities</a></th>
                    <td><a href="#slide38">38</a></td>
                </tr>
                
                <tr id="toc-row-39" class="sub">
                    <th><a href="#slide39">Using Orion's geolocation capabilities</a></th>
                    <td><a href="#slide39">39</a></td>
                </tr>
                
                <tr id="toc-row-40" class="sub">
                    <th><a href="#slide40">A Real Example</a></th>
                    <td><a href="#slide40">40</a></td>
                </tr>
                
                <tr id="toc-row-41" class="sub">
                    <th><a href="#slide41">A Real Example</a></th>
                    <td><a href="#slide41">41</a></td>
                </tr>
                
                <tr id="toc-row-42" class="sub">
                    <th><a href="#slide42">A Real Example</a></th>
                    <td><a href="#slide42">42</a></td>
                </tr>
                
                
                
                <tr id="toc-row-43">
                    <th><a href="#slide43">-</a></th>
                    <td><a href="#slide43">43</a></td>
                </tr>
                
                
            </table>
        </div>
        
        <div id="help" class="sidebar hidden">
            <h2>Help</h2>
            <table>
                <caption>Help</caption>
                <tr>
                    <th>Table of Contents</th>
                    <td>t</td>
                </tr>
                <tr>
                    <th>Exposé</th>
                    <td>ESC</td>
                </tr>
                <tr>
                    <th>Full screen slides</th>
                    <td>e</td>
                </tr>
                <tr>
                    <th>Presenter View</th>
                    <td>p</td>
                </tr>
                <tr>
                    <th>Source Files</th>
                    <td>s</td>
                </tr>
                <tr>
                    <th>Slide Numbers</th>
                    <td>n</td>
                </tr>
                <tr>
                    <th>Toggle screen blanking</th>
                    <td>b</td>
                </tr>
                <tr>
                    <th>Show/hide slide context</th>
                    <td>c</td>
                </tr>
                <tr>
                    <th>Notes</th>
                    <td>2</td>
                </tr>
                <tr>
                    <th>Help</th>
                    <td>h</td>
                </tr>
            </table>
        </div>
        <script>main()</script>
    </body>
</html>