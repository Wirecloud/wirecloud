<!DOCTYPE html>
<!--
Copyright 2010 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Original slides: Marcin Wichary (mwichary@google.com)
Modifications: Ernest Delgado (ernestd@google.com)
Alex Russell (slightlyoff@chromium.org)

landslide modifications: Adam Zapletal (adamzap@gmail.com)
Nicolas Perriault (nperriault@gmail.com)
-->
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no" />
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>Quick Start Tutorial</title>
        <!-- Styles -->
        
        <link rel="stylesheet" media="print" href="./fiwaretheme/css/print.css">
        <link rel="stylesheet" media="screen, projection" href="./fiwaretheme/css/screen.css">
        
        
        <!-- /Styles -->
        <!-- Javascripts -->
        
        <script type="text/javascript" src="./fiwaretheme/js/slides.js"></script>
        
        
        <!-- /Javascripts -->
    </head>
    <body>
        <div id="blank"></div>
        <div class="presentation">
            <div id="current_presenter_notes">
                <div id="presenter_note"></div>
            </div>
            <div class="slides">
                
                <div class="slide-wrapper">
                    <section class="slide cover">
                        

                        <header class="slide-header"><h1>Quick Start Tutorial</h1><h2>Application Mashup (WireCloud) course @ https://fiware-academy.readthedocs.io/</h2></header>
                        <img class="fiware-contact" src="fiwaretheme/images/FIWARE-contact.png"/>
                        <img class="fiware-logo" src="fiwaretheme/images/FIWARE-full.png"/>
                        <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops-full.png"/>

                        <div class="navigation-tip">Use <kbd class="key">←</kbd> and <kbd class="key">→</kbd> to move around. Press <kbd class="key">h</kbd> for getting more info</div>
                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Quick Start Tutorial</h1>
                            <h2><h2>Introduction</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Introduction</h2>
                        </header>
                        
                        <div class="contents"><p>What do you need:</p>
<ul>
<li>And editor of your choice</li>
<li>A zip tool</li>
<li>A <a href="https://gravatar.com">gravatar</a> account/profile</li>
</ul></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            3/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Introduction</h2>
                        </header>
                        
                        <div class="contents"><h3>Reference implementation</h3>
<p>You can find the reference implementation of the widget and the operator build
in this tutorial in the following github repo:</p>
<p><a href="https://github.com/wirecloud-fiware/quick-start-development-tutorial">https://github.com/wirecloud-fiware/quick-start-development-tutorial</a></p>
<p>We recommend you to see it after completing the tutorial or in case you get stalled.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            4/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Quick Start Tutorial</h1>
                            <h2><h2>Basic chat widget</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial version</h3>
<p>The first step is to build a blank widget. It must have defined the metadata and a basic HTML. The metadata is written in the <code>config.xml</code> file, that could be similar to this:</p>
<div class="highlight"><pre><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
<span class="nt">&lt;widget</span> <span class="na">xmlns=</span><span class="s">&quot;http://wirecloud.conwet.fi.upm.es/ns/macdescription/1&quot;</span> <span class="na">vendor=</span><span class="s">&quot;CoNWeT&quot;</span> <span class="na">name=</span><span class="s">&quot;basic-chat&quot;</span> <span class="na">version=</span><span class="s">&quot;0.1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;details&gt;</span>
        <span class="nt">&lt;title&gt;</span>Basic chat<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;homepage&gt;</span>https://github.com/wirecloud-fiware/quick-start-development-tutorial<span class="nt">&lt;/homepage&gt;</span>
        <span class="nt">&lt;authors&gt;</span>Miguel Jimenez <span class="ni">&amp;lt;</span>mjimenez@fi.upm.es<span class="ni">&amp;gt;</span><span class="nt">&lt;/authors&gt;</span>
        <span class="nt">&lt;contributors&gt;</span>Álvaro Arranz <span class="ni">&amp;lt;</span>aarranz@fi.upm.es<span class="ni">&amp;gt;</span><span class="nt">&lt;/contributors&gt;</span>
        <span class="nt">&lt;email&gt;</span>wirecloud@conwet.com<span class="nt">&lt;/email&gt;</span>
        <span class="nt">&lt;image&gt;</span>images/chat_logo.png<span class="nt">&lt;/image&gt;</span> <span class="c">&lt;!-- 170x80 --&gt;</span>
        <span class="nt">&lt;description&gt;</span>Basic chat functionality and WireCloud features demonstrator<span class="nt">&lt;/description&gt;</span>
        <span class="nt">&lt;longdescription&gt;</span>README.md<span class="nt">&lt;/longdescription&gt;</span>
        <span class="nt">&lt;license&gt;</span>Apache License 2.0<span class="nt">&lt;/license&gt;</span>
        <span class="nt">&lt;licenseurl&gt;</span>http://www.apache.org/licenses/LICENSE-2.0.html<span class="nt">&lt;/licenseurl&gt;</span>
        <span class="nt">&lt;doc&gt;</span>doc/developer-guide.md<span class="nt">&lt;/doc&gt;</span>
    <span class="nt">&lt;/details&gt;</span>
    <span class="nt">&lt;contents</span> <span class="na">src=</span><span class="s">&quot;index.html&quot;</span> <span class="na">useplatformstyle=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;rendering</span> <span class="na">width=</span><span class="s">&quot;5&quot;</span> <span class="na">height=</span><span class="s">&quot;24&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/widget&gt;</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            6/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial version</h3>
<p>That template indicates widget metadata such as author/vendor, together with longer descriptions that can be written using Markdown.</p>
<p>Note the <code>vendor</code>, <code>name</code> and <code>version</code> indicated as attributes of the root element. Please consider that, depending on the WireCloud configuration, it might not admit uploading a widget twice (same version/name/vendor), so you should increase version, subversion or revision number to upload new versions of the widget. Moreover, you must change the vendor, since WireCloud will not upload the widget if another user has uploaded already the same widget (version, name and vendor).</p>
<p>Two remarkable elements are the <code>rendering</code> element, with basic information about the size of the widget, and the reference to the main HTML file. Such file will be the entry point to the widget, and contains references to JavaScript or CSS files.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            7/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial version</h3>
<p>A basic HTML, named <code>index.html</code> as indicated in <code>config.xml</code> is indicated below. This document contains a basic header for user photo and nickname, a panel for messages, and a basic form for sending messages.</p>
<div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;application/xhtml+xml; charset=UTF-8&quot;</span><span class="nt">&gt;&lt;/meta&gt;</span>
        <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;js/main.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href=</span><span class="s">&quot;css/style.css&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;header&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">&quot;photo&quot;</span><span class="na">id=</span><span class="s">&quot;photo&quot;</span>  <span class="na">alt=</span><span class="s">&quot;Profile photo&quot;</span> <span class="na">max-height=</span><span class="s">&quot;60&quot;</span> <span class="na">max-width=</span><span class="s">&quot;60&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">&quot;username&quot;</span><span class="nt">&gt;</span>Username<span class="nt">&lt;/h2&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;conversations&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;footer&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;input&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="nt">/&gt;&lt;button</span> <span class="na">id=</span><span class="s">&quot;send&quot;</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span><span class="nt">&gt;</span>Send<span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            8/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial version</h3>
<p>This HTML code refers to the <code>js/main.js</code> JavaScript file, that should contain the necessary code. JavaScript code will be throroughly described below. In addition, a CSS file is referenced, containing basic styling for our chat application.</p>
<div class="highlight"><pre><span class="nt">body</span> <span class="p">{</span>  <span class="k">padding</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="k">font-family</span><span class="o">:</span> <span class="k">sans-serif</span><span class="p">;</span>
        <span class="k">color</span><span class="o">:</span> <span class="m">#333</span><span class="p">;}</span>
<span class="nf">#photo</span> <span class="p">{</span><span class="k">padding</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
        <span class="k">border</span><span class="o">:</span> <span class="m">2px</span> <span class="k">solid</span> <span class="m">#eaeaea</span><span class="p">;</span>
        <span class="k">max-height</span><span class="o">:</span> <span class="m">48px</span><span class="p">;</span>
        <span class="k">max-width</span><span class="o">:</span> <span class="m">48px</span><span class="p">;</span>
        <span class="k">float</span><span class="o">:</span><span class="k">left</span><span class="p">;}</span>
<span class="nc">.sent</span><span class="o">,</span> <span class="nc">.received</span> <span class="p">{</span>
        <span class="k">min-height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span>
        <span class="k">padding</span><span class="o">:</span> <span class="m">2px</span><span class="p">;</span>
        <span class="k">border</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="m">#eaeaea</span><span class="p">;</span>
        <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">5px</span><span class="p">;}</span>
<span class="nc">.sent</span> <span class="p">{</span>  <span class="k">margin</span><span class="o">:</span> <span class="m">1px</span> <span class="m">35px</span> <span class="m">1px</span> <span class="m">1px</span><span class="p">;}</span>
<span class="nc">.received</span><span class="p">{</span> <span class="k">margin</span><span class="o">:</span> <span class="m">1px</span> <span class="m">1px</span> <span class="m">1px</span> <span class="m">35px</span><span class="p">;</span>
        <span class="k">text-align</span><span class="o">:</span> <span class="k">right</span><span class="p">;}</span>
<span class="nc">.received</span> <span class="o">&gt;</span> <span class="nt">p</span><span class="p">{</span> <span class="k">display</span><span class="o">:</span> <span class="k">inline</span><span class="p">;}</span>
<span class="nc">.sent</span> <span class="o">&gt;</span> <span class="nt">img</span><span class="p">{</span> <span class="k">max-height</span><span class="o">:</span> <span class="m">28px</span><span class="p">;</span>
        <span class="k">max-width</span><span class="o">:</span> <span class="m">28px</span><span class="p">;</span>
        <span class="k">margin</span><span class="o">:</span> <span class="m">2px</span><span class="p">;</span>
        <span class="k">float</span><span class="o">:</span><span class="k">left</span><span class="p">;}</span>
<span class="nc">.sent</span> <span class="o">&gt;</span> <span class="nt">p</span><span class="p">{</span> <span class="k">display</span><span class="o">:</span><span class="k">inline</span><span class="p">;}</span>
<span class="nc">.received</span> <span class="o">&gt;</span> <span class="nt">img</span><span class="p">{</span> <span class="k">max-height</span><span class="o">:</span> <span class="m">28px</span><span class="p">;</span>
        <span class="k">max-width</span><span class="o">:</span> <span class="m">28px</span><span class="p">;</span>
        <span class="k">margin</span><span class="o">:</span> <span class="m">2px</span><span class="p">;</span>
        <span class="k">float</span><span class="o">:</span><span class="k">right</span><span class="p">;}</span>
<span class="nf">#username</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span> <span class="k">inline</span><span class="p">;}</span>
<span class="nf">#conversations</span> <span class="p">{</span> <span class="k">height</span><span class="o">:</span> <span class="m">65%</span><span class="p">;</span>
        <span class="k">overflow</span><span class="o">:</span> <span class="k">scroll</span><span class="p">;}</span>
<span class="nf">#footer</span><span class="p">{</span><span class="k">position</span><span class="o">:</span> <span class="k">fixed</span><span class="p">;</span>
        <span class="k">bottom</span><span class="o">:</span> <span class="m">0</span><span class="p">;}</span>
<span class="nf">#header</span><span class="p">{</span><span class="k">height</span><span class="o">:</span><span class="m">60px</span><span class="p">;}</span>
<span class="nt">body</span><span class="o">,</span><span class="nt">html</span> <span class="p">{</span> <span class="k">height</span><span class="o">:</span> <span class="m">100%</span><span class="p">;}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            9/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial version</h3>
<p>Finally, the referenced <code>js/main.js</code> is created. Here we include some basic elements such as a closure, an <code>init()</code> function and two functions to deal with the HTML interface.</p>
<div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

    <span class="c1">// object with the data received from gravatar</span>
    <span class="kd">var</span> <span class="nx">userData</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;send&quot;</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="nx">sendBtnHandler</span><span class="p">;</span>
        <span class="nx">getInfoFromGravatar</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">sendBtnHandler</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">createMsgDiv</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span><span class="nx">imageSrc</span><span class="p">,</span><span class="nx">received</span><span class="p">,</span><span class="nx">id</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">newMsgP</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">newMsgImg</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">newMsgDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
        <span class="nx">newMsgP</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">text</span><span class="p">;</span>
        <span class="nx">newMsgP</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
        <span class="nx">newMsgImg</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">imageSrc</span><span class="p">;</span>
        <span class="nx">newMsgImg</span><span class="p">.</span><span class="nx">alt</span> <span class="o">=</span> <span class="s1">&#39;User profile img&#39;</span><span class="p">;</span>
        <span class="nx">newMsgDiv</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="p">(</span><span class="nx">received</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;received&#39;</span><span class="o">:</span><span class="s1">&#39;sent&#39;</span><span class="p">;</span>
        <span class="nx">newMsgDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">newMsgImg</span><span class="p">);</span>
        <span class="nx">newMsgDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">newMsgP</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">conversations</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;conversations&#39;</span><span class="p">);</span>
        <span class="nx">conversations</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">newMsgDiv</span><span class="p">);</span>
        <span class="nx">conversations</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">newMsgDiv</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">getInfoFromGravatar</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Put the info in userData variable</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">printUserData</span><span class="p">(</span><span class="nx">user_data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">user_data</span><span class="p">.</span><span class="nx">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">displayName</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;photo&#39;</span><span class="p">).</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">user_data</span><span class="p">.</span><span class="nx">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">thumbnailUrl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;DOMContentLoaded&#39;</span><span class="p">,</span> <span class="nx">init</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="kc">true</span><span class="p">);</span>

<span class="p">})();</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            10/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Adding preferences</h3>
<p>The first feature that we are adding is preferences. Widget preferences must be declared in the <code>config.xml</code>, and after they're accessed through the WireCloud JavaScript API. The declaration of a preference for getting user gravatar profile would be like this:</p>
<div class="highlight"><pre><span class="nt">&lt;preferences&gt;</span>
    <span class="nt">&lt;preference</span> <span class="na">name=</span><span class="s">&quot;gravatar&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">label=</span><span class="s">&quot;Gravatar URL&quot;</span> <span class="na">description=</span><span class="s">&quot;URL to the gravatar profile of the user&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/preferences&gt;</span>
</pre></div>

<p>This <code>&lt;preferences&gt;</code> section must be inside the root element <code>&lt;widget&gt;</code>. Now we can access its value using the <code>name</code> we've chosen. The following line will be inside the <code>getInfoFromGravatar()</code> function, so it can make the HTTP request to the specific URL.</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">gravatarURL</span> <span class="o">=</span> <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">prefs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;gravatar&#39;</span><span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            11/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Adding preferences</h3>
<p>If we did this only, once the user has indicated his profile we would have to reload the widget so as to get the profile from Gravatar. To do things smartly, we're being notified from the platform on any preferences change, and react accordingly. In this case, we will invoke <code>getInfoFromGravatar()</code> again. Following code goes inside <code>init()</code> function:</p>
<div class="highlight"><pre>    <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">prefs</span><span class="p">.</span><span class="nx">registerCallback</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">new_values</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;gravatar&#39;</span> <span class="k">in</span> <span class="nx">new_values</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">getInfoFromGravatar</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">});</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            12/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Making an HTTP request</h3>
<p>Now it's time to make the HTTP request to gather other information from the user. Gravatar offers a JSON version of the profile on the same URL, appending a '.json' extension, so that will be the base URL for our request.</p>
<p>The basic HTTP request might be like this:</p>
<div class="highlight"><pre>    <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="nx">makeRequest</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
        <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">user_data</span><span class="p">;</span>
            <span class="nx">user_data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">user_data</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// handle error</span>
                <span class="nx">onError</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// perform actions</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">onError</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">onError</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">});</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            13/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Making an HTTP request</h3>
<p>This structure is invoked with the URL resulted from the concatenation of the obtained user preference <code>gravatarURL</code> and the string <code>'.json'</code>. And the actions to be performed are storing the data on the <code>userData</code> variable, and making it appear on the widget using the previously created <code>printUserData()</code> function:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">gravatarURL</span> <span class="o">+</span> <span class="s1">&#39;.json&#39;</span><span class="p">;</span>

<span class="p">...</span>

    <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">user_data</span><span class="p">;</span>
        <span class="nx">user_data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">user_data</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">onError</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">userData</span> <span class="o">=</span> <span class="nx">user_data</span><span class="p">;</span>
            <span class="nx">printUserData</span><span class="p">(</span><span class="nx">user_data</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            14/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Making an HTTP request</h3>
<p>The <code>userData</code> obtained from gravatar has a simple structure that is used for accessin its information, for example on the <code>printUserData()</code>:</p>
<div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;entry&quot;</span><span class="o">:</span> <span class="p">[{</span>
        <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;9508921&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hash&quot;</span><span class="o">:</span> <span class="s2">&quot;61ac3cca6452efd339cb85c7864c147b&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requestHash&quot;</span><span class="o">:</span> <span class="s2">&quot;mjimenezganan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;profileUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http:\/\/gravatar.com\/mjimenezganan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preferredUsername&quot;</span><span class="o">:</span> <span class="s2">&quot;mjimenezganan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;thumbnailUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;http:\/\/2.gravatar.com\/avatar\/61ac3cca6452efd339cb85c7864c147b&quot;</span><span class="p">,</span>
        <span class="s2">&quot;photos&quot;</span><span class="o">:</span> <span class="p">[{</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;http:\/\/2.gravatar.com\/avatar\/61ac3cca6452efd339cb85c7864c147b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;thumbnail&quot;</span>
        <span class="p">}],</span>
        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;givenName&quot;</span><span class="o">:</span> <span class="s2">&quot;Miguel&quot;</span><span class="p">,</span>
            <span class="s2">&quot;familyName&quot;</span><span class="o">:</span> <span class="s2">&quot;Jim\u00e9nez&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;displayName&quot;</span><span class="o">:</span> <span class="s2">&quot;mjimenezganan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;aboutMe&quot;</span><span class="o">:</span> <span class="s2">&quot;More info on www.twitter.com\/miguel_jimg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;currentLocation&quot;</span><span class="o">:</span> <span class="s2">&quot;Spain&quot;</span><span class="p">,</span>
        <span class="s2">&quot;urls&quot;</span><span class="o">:</span> <span class="p">[]</span>
    <span class="p">}]</span>
<span class="p">}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            15/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Sending and receiving through wiring</h3>
<p>Chat functionality on the widget is done through the wiring mechanism of WireCloud. First of all, input and output endpoints have to be declared on the <code>config.xml</code> file:</p>
<div class="highlight"><pre><span class="nt">&lt;wiring&gt;</span>
    <span class="nt">&lt;outputendpoint</span> <span class="na">name=</span><span class="s">&quot;sendMsg&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">label=</span><span class="s">&quot;Send a message&quot;</span> <span class="na">description=</span><span class="s">&quot;The messages sent by the user are sent through this output endpoint&quot;</span> <span class="na">friendcode=</span><span class="s">&quot;message&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;inputendpoint</span> <span class="na">name=</span><span class="s">&quot;receiveMsg&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">label=</span><span class="s">&quot;Receive a message&quot;</span>  <span class="na">description=</span><span class="s">&quot;This is where messages sent by other widgets can be received&quot;</span> <span class="na">friendcode=</span><span class="s">&quot;message&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/wiring&gt;</span>
</pre></div>

<p>Sending messages implies invoking the <code>MashupPlatform.wiring.pushEvent()</code> function referencing the output endpoint name as declared.</p>
<div class="highlight"><pre><span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">wiring</span><span class="p">.</span><span class="nx">pushEvent</span><span class="p">(</span><span class="s1">&#39;sendMsg&#39;</span><span class="p">,</span> <span class="nx">text</span><span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            16/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Sending and receiving through wiring</h3>
<p>It shall be added to the <code>sendBtnHandler()</code>. To be able to send messages with metadata (i.e. the Gravatar hash that allows getting sender's image), a JSON serialized object is sent:</p>
<div class="highlight"><pre><span class="kd">function</span> <span class="nx">sendBtnHandler</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">msgToSend</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">msgToSend</span><span class="p">.</span><span class="nx">msg</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">msgToSend</span><span class="p">.</span><span class="nx">msg</span> <span class="o">!==</span> <span class="s2">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">userData</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">msgToSend</span><span class="p">.</span><span class="nx">hash</span><span class="o">=</span> <span class="nx">userData</span><span class="p">.</span><span class="nx">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">hash</span><span class="p">;</span>
        <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">wiring</span><span class="p">.</span><span class="nx">pushEvent</span><span class="p">(</span><span class="s1">&#39;sendMsg&#39;</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgToSend</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            17/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Sending and receiving through wiring</h3>
<p>Now the message is sent through wiring, but the widget needs to receive other widgets' messages and print them on the conversations panel. This is performed registering a callback function on the platform registering for messages received on a specific input endpoint. identified by its name. On the <code>init()</code> function we would write somethint like this:</p>
<div class="highlight"><pre><span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">wiring</span><span class="p">.</span><span class="nx">registerCallback</span><span class="p">(</span><span class="s1">&#39;receiveMsg&#39;</span><span class="p">,</span> <span class="nx">processMsg</span><span class="p">);</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            18/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic chat widget</h2>
                        </header>
                        
                        <div class="contents"><h3>Sending and receiving through wiring</h3>
<p>And a <code>processMsg()</code> function shall be created to indicate the desired behaviour. In our case, creating a message in the conversations panel. Since messages are sent as serialized JSON objects, they are de-serialized for accessing its elements. It is a bit tricky, since it detects my own messages and prints them as sent (different CSS style). This is how the echo is going to work.</p>
<div class="highlight"><pre><span class="kd">function</span> <span class="nx">processMsg</span><span class="p">(</span><span class="nx">event_data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">receivedMsg</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">event_data</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">userData</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">receivedMsg</span><span class="p">.</span><span class="nx">hash</span> <span class="o">!==</span> <span class="nx">userData</span><span class="p">.</span><span class="nx">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">createMsgDiv</span><span class="p">(</span><span class="nx">receivedMsg</span><span class="p">.</span><span class="nx">msg</span><span class="p">,</span> <span class="s1">&#39;http://www.gravatar.com/avatar/&#39;</span> <span class="o">+</span> <span class="nx">receivedMsg</span><span class="p">.</span><span class="nx">hash</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">receivedMsg</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// My message, echo, mark as sent</span>
        <span class="nx">createMsgDiv</span><span class="p">(</span><span class="nx">receivedMsg</span><span class="p">.</span><span class="nx">msg</span><span class="p">,</span><span class="s1">&#39;http://www.gravatar.com/avatar/&#39;</span> <span class="o">+</span> <span class="nx">receivedMsg</span><span class="p">.</span><span class="nx">hash</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">receivedMsg</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">receivedMsg</span><span class="p">.</span><span class="nx">id</span><span class="p">).</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;sent&#39;</span><span class="p">;</span> 
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            19/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide section-title">
                        

                        <header class="section-title-header">
                            <h1>Quick Start Tutorial</h1>
                            <h2><h2>Basic NGSI chat operator</h2></h2>
                        </header>

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial operator</h3>
<p>The operator is defined on a <code>config.xml</code> declarative file, which references one or many JavaScript files containing its behaviour.</p>
<p>Like widgets, the <code>config.xml</code> has vendor, name and version information that should be updated so as to avoid conflicts or WireCloud rejecting an operator.</p>
<div class="highlight"><pre><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
<span class="nt">&lt;operator</span> <span class="na">xmlns=</span><span class="s">&quot;http://wirecloud.conwet.fi.upm.es/ns/macdescription/1&quot;</span>
    <span class="na">vendor=</span><span class="s">&quot;CoNWeT&quot;</span> <span class="na">name=</span><span class="s">&quot;ngsi-chat-op&quot;</span> <span class="na">version=</span><span class="s">&quot;0.1.1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;details&gt;</span>
        <span class="nt">&lt;title&gt;</span>NGSI chat operator<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;homepage&gt;</span>https://github.com/wirecloud-fiware/quick-start-development-tutorial<span class="nt">&lt;/homepage&gt;</span>
        <span class="nt">&lt;authors&gt;</span>Miguel Jiménez<span class="nt">&lt;/authors&gt;</span>
        <span class="nt">&lt;email&gt;</span>mjimenez@fi.upm.es<span class="nt">&lt;/email&gt;</span>
        <span class="nt">&lt;image&gt;</span>images/operator_logo.png<span class="nt">&lt;/image&gt;</span> <span class="c">&lt;!-- 170x80 --&gt;</span>
        <span class="nt">&lt;description&gt;</span>Connect to Orion Context Broker through NGSI WireCloud API for chat room<span class="nt">&lt;/description&gt;</span>
        <span class="nt">&lt;longdescription&gt;</span>README.md<span class="nt">&lt;/longdescription&gt;</span>
        <span class="nt">&lt;license&gt;</span>Apache License 2.0<span class="nt">&lt;/license&gt;</span>
        <span class="nt">&lt;licenseurl&gt;</span>http://www.apache.org/licenses/LICENSE-2.0.html<span class="nt">&lt;/licenseurl&gt;</span>
        <span class="nt">&lt;doc&gt;</span>doc/developer-guide.md<span class="nt">&lt;/doc&gt;</span>
    <span class="nt">&lt;/details&gt;</span>
    <span class="nt">&lt;scripts&gt;</span>
        <span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;js/main.js&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/scripts&gt;</span>
<span class="nt">&lt;/operator&gt;</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            21/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial operator</h3>
<p>The widget has some preferences for easy indicating the URLs of the NGSI server and the proxy for accessing it from widgets/operators. Moreover, a <code>chatroom</code> preference has been added.</p>
<div class="highlight"><pre>    <span class="nt">&lt;preferences&gt;</span>
        <span class="nt">&lt;preference</span> <span class="na">name=</span><span class="s">&quot;ngsi_server&quot;</span>
            <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">label=</span><span class="s">&quot;NGSI server URL&quot;</span>
            <span class="na">description=</span><span class="s">&quot;URL of the Orion Context Broker to use for retrieving entity information&quot;</span>
            <span class="na">default=</span><span class="s">&quot;http://orion.lab.fiware.org:10026/&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;preference</span> <span class="na">name=</span><span class="s">&quot;ngsi_proxy&quot;</span>
            <span class="na">type=</span><span class="s">&quot;text&quot;</span>
            <span class="na">label=</span><span class="s">&quot;NGSI proxy URL&quot;</span>
            <span class="na">description=</span><span class="s">&quot;URL of the PubSub Context Broker proxy to use for receiving notifications about changes&quot;</span>
            <span class="na">default=</span><span class="s">&quot;https://ngsiproxy.lab.fiware.org/&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;preference</span> <span class="na">name=</span><span class="s">&quot;chatroom&quot;</span>
            <span class="na">type=</span><span class="s">&quot;text&quot;</span>
            <span class="na">label=</span><span class="s">&quot;Chat room&quot;</span>
            <span class="na">description=</span><span class="s">&quot;Chat room to send and receive messages&quot;</span>
            <span class="na">default=</span><span class="s">&quot;Startup Weekends&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/preferences&gt;</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            22/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial operator</h3>
<p>Wiring is also used in the widget. It sends received messages back to the widget, and forwards user messages to the NGSI API:</p>
<div class="highlight"><pre>    <span class="nt">&lt;wiring&gt;</span>
        <span class="nt">&lt;outputendpoint</span> <span class="na">name=</span><span class="s">&quot;toBeReceived&quot;</span>
            <span class="na">type=</span><span class="s">&quot;text&quot;</span>
            <span class="na">label=</span><span class="s">&quot;Messages from NGSI&quot;</span>
            <span class="na">description=</span><span class="s">&quot;Forward a message to a chat widget&quot;</span>
            <span class="na">friendcode=</span><span class="s">&quot;message&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;inputendpoint</span> <span class="na">name=</span><span class="s">&quot;toBeSent&quot;</span>
            <span class="na">type=</span><span class="s">&quot;text&quot;</span>
            <span class="na">label=</span><span class="s">&quot;Message to NGSI&quot;</span>
            <span class="na">description=</span><span class="s">&quot;Receive messages to be sent to the chat room&quot;</span>
            <span class="na">friendcode=</span><span class="s">&quot;message&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/wiring&gt;</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            23/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>Initial operator</h3>
<p>Basic JavaScript file is written below, containing initialization function, preferences and wiring subscriptions and some skeletons:</p>
<div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">chatroom</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">ngsi_connection</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">wiring</span><span class="p">.</span><span class="nx">registerCallback</span><span class="p">(</span><span class="s1">&#39;toBeSent&#39;</span><span class="p">,</span> <span class="nx">publishMsg</span><span class="p">);</span>
        <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">prefs</span><span class="p">.</span><span class="nx">registerCallback</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">new_values</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;chatroom&#39;</span> <span class="k">in</span> <span class="nx">new_values</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">subscribeChatRoom</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="nx">subscribeChatRoom</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">function</span> <span class="nx">publishMsg</span><span class="p">(</span><span class="nx">event_data</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">subscribeChatRoom</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">receiveMessage</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">msg</span> <span class="k">in</span> <span class="nx">data</span><span class="p">.</span><span class="nx">elements</span><span class="p">){</span>
            <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">wiring</span><span class="p">.</span><span class="nx">pushEvent</span><span class="p">(</span><span class="s1">&#39;toBeReceived&#39;</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">elements</span><span class="p">[</span><span class="nx">msg</span><span class="p">]));</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">init</span><span class="p">();</span>

<span class="p">})();</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            24/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>NGSI connection</h3>
<p>First, NGSI must be declared as a required feature in the <code>config.xml</code> file:</p>
<div class="highlight"><pre>    <span class="nt">&lt;requirements&gt;</span>
        <span class="nt">&lt;feature</span> <span class="na">name=</span><span class="s">&quot;NGSI&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/requirements&gt;</span>
</pre></div>

<p>An NGSI connection must be stablished so as to make requests over it. It is authenticating using FIWARE tokens from the user logged on WireCloud. I've declared a global (closure) variable to hold it and access from other functions.</p>
<div class="highlight"><pre><span class="nx">ngsi_connection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NGSI</span><span class="p">.</span><span class="nx">Connection</span><span class="p">(</span><span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">prefs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ngsi_server&#39;</span><span class="p">),</span> <span class="p">{</span>
    <span class="nx">use_user_fiware_token</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">ngsi_proxy_url</span><span class="o">:</span> <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">prefs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ngsi_proxy&#39;</span><span class="p">)</span>
<span class="p">});</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            25/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>NGSI publication</h3>
<p>To create a new entity or modify an existing one, function <code>addAttributes()</code> of
the connection is used. For the chat application, a new instance of class
<code>ChatMessage</code>is created, using its <code>hash</code> and <code>msg</code> attributes (exactly as the
event sent by wiring). Further information can be found on the <a href="https://wirecloud.readthedocs.org/en/latest/development/ngsi_api/">NGSI API of
WireCloud documentation</a> or on the <a href="3.2.1_Using Orion Context Broker">Orion Context Broker with WireCloud
tutorial</a>.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            26/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code code-block">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>NGSI publication</h3>
<p>The entity to create is like this one, that</p>
<div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">entity</span><span class="o">:</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">prefs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;chatroom&#39;</span><span class="p">)</span> <span class="o">+</span>  <span class="nx">now</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">hash</span><span class="p">,</span>
             <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;ChatMessage&#39;</span><span class="p">},</span>
    <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;hash&#39;</span><span class="p">,</span>
            <span class="nx">contextValue</span><span class="o">:</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">hash</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;msg&#39;</span><span class="p">,</span>
            <span class="nx">contextValue</span><span class="o">:</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">msg</span>
        <span class="p">}]</span>
<span class="p">}]</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            27/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>NGSI publication</h3>
<p>Full <code>publishMsg()</code> definition ends like this:</p>
<div class="highlight"><pre><span class="kd">function</span> <span class="nx">publishMsg</span><span class="p">(</span><span class="nx">event_data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">event_data</span><span class="p">);</span>
    <span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">addAttributes</span><span class="p">([{</span>
        <span class="nx">entity</span><span class="o">:</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">prefs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;chatroom&#39;</span><span class="p">)</span> <span class="o">+</span>  <span class="nx">now</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">hash</span><span class="p">,</span>
                 <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;ChatMessage&#39;</span><span class="p">},</span>
        <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
                <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;hash&#39;</span><span class="p">,</span>
                <span class="nx">contextValue</span><span class="o">:</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">hash</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
                <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;msg&#39;</span><span class="p">,</span>
                <span class="nx">contextValue</span><span class="o">:</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">msg</span>
            <span class="p">}]</span>
    <span class="p">}]);</span>
<span class="p">}</span>
</pre></div>

<p>Note that the ID of the entity has been created with a fixed part (a preference indicating the chat room), plus a timestamp and the hash of the user writing.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            28/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>NGSI subscription</h3>
<p>This operator wants to receive the modification (creation is a kind of
modification) of any instance of type <code>ChatMessage</code> whose ID starts with the
chat room. If we had previously created the subscription (stored on <code>chatroom</code>
variable), we start cancelling it.</p>
<p>The subcription itself is created invoking the
<a href="https://wirecloud.readthedocs.org/en/latest/development/ngsi_api/#createsubscription"><code>createSubscription()</code></a> method. It requires several
parameters (like the id of the entities to monitorize, the list of attribute
your interested on, the duration of the subscription, etc), in the next slide
you will see an example of use for our scenario.</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            29/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide has_code code-block code-block-xs">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>NGSI subscription</h3>
<div class="highlight"><pre><span class="kd">function</span> <span class="nx">subscribeChatRoom</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">chatroom</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">NGSI</span><span class="p">.</span><span class="nx">cancelSubscription</span><span class="p">(</span><span class="nx">chatroom</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">entityIdList</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;ChatMessage&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="nx">MashupPlatform</span><span class="p">.</span><span class="nx">prefs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;chatroom&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.*&#39;</span><span class="p">,</span> <span class="nx">isPattern</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
    <span class="p">];</span>
    <span class="kd">var</span> <span class="nx">attributeList</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">duration</span> <span class="o">=</span> <span class="s1">&#39;PT30M&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">throttling</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">notifyConditions</span> <span class="o">=</span> <span class="p">[{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;ONCHANGE&#39;</span><span class="p">,</span>
        <span class="nx">condValues</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;hash&#39;</span><span class="p">,</span> <span class="s1">&#39;msg&#39;</span><span class="p">]</span>
    <span class="p">}];</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">flat</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">onNotify</span><span class="o">:</span> <span class="nx">receiveMessage</span><span class="p">,</span>
        <span class="nx">onSuccess</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">chatroom</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">subscriptionId</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">ngsi_connection</span><span class="p">.</span><span class="nx">createSubscription</span><span class="p">(</span><span class="nx">entityIdList</span><span class="p">,</span> <span class="nx">attributeList</span><span class="p">,</span> <span class="nx">duration</span><span class="p">,</span> <span class="nx">throttling</span><span class="p">,</span> <span class="nx">notifyConditions</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            30/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide">
                        

                        
                        <header class="slide-header">
                            <h2>Basic NGSI chat operator</h2>
                        </header>
                        
                        <div class="contents"><h3>Renew NGSI subcriptions</h3>
<p>The subscription duration is set to 30 minutes, and should be renewed (or the
page reloaded) before that time. How to renew the subscription will be addressed
in future versions of this tutorial (in the meantime, you can take a look to the
<a href="3.2.1_Using Orion Context Broker">Orion Context Broker with WierCloud tutorial</a>
for a generic tutorial of how to do it).</p></div>
                        

                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            <aside class="page_number">
                            31/32
                            </aside>
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
                <div class="slide-wrapper">
                    <section class="slide back-cover">
                        
                        <div>Thanks!</div>
                        <img class="fiware-contact" src="fiwaretheme/images/FIWARE-contact.png"/>
                        <img class="fiware-logo" src="fiwaretheme/images/FIWARE-full.png"/>
                        <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops-full.png"/>
                        
                        <footer>
                            
                            <aside class="source">Source: <a href="3.1.0_quick_start.md">3.1.0_quick_start.md</a></aside>
                            
                            
                            
                            <img class="fiware-logo" src="fiwaretheme/images/FIWARE.png" />
                            <img class="fiware-lab-ops-logo" src="fiwaretheme/images/FIWARE-lab-ops.png" />
                            
                        </footer>
                        <div class="presenter_notes">
                            <header><h1>Presenter Notes</h1></header>
                            <section>
                            
                            </section>
                        </div>
                    </section>
                </div>
                
            </div>
        </div>
        
        <div id="toc" class="sidebar hidden">
            <h2>Table of Contents</h2>
            <table>
                <caption>Table of Contents</caption>
                
                <tr id="toc-row-1">
                    <th><a href="#slide1">Quick Start Tutorial</a></th>
                    <td><a href="#slide1">1</a></td>
                </tr>
                
                
                <tr id="toc-row-2" class="sub">
                    <th><a href="#slide2">Introduction</a></th>
                    <td><a href="#slide2">2</a></td>
                </tr>
                
                <tr id="toc-row-3" class="sub">
                    <th><a href="#slide3">Introduction</a></th>
                    <td><a href="#slide3">3</a></td>
                </tr>
                
                <tr id="toc-row-4" class="sub">
                    <th><a href="#slide4">Introduction</a></th>
                    <td><a href="#slide4">4</a></td>
                </tr>
                
                <tr id="toc-row-5" class="sub">
                    <th><a href="#slide5">Basic chat widget</a></th>
                    <td><a href="#slide5">5</a></td>
                </tr>
                
                <tr id="toc-row-6" class="sub">
                    <th><a href="#slide6">Basic chat widget</a></th>
                    <td><a href="#slide6">6</a></td>
                </tr>
                
                <tr id="toc-row-7" class="sub">
                    <th><a href="#slide7">Basic chat widget</a></th>
                    <td><a href="#slide7">7</a></td>
                </tr>
                
                <tr id="toc-row-8" class="sub">
                    <th><a href="#slide8">Basic chat widget</a></th>
                    <td><a href="#slide8">8</a></td>
                </tr>
                
                <tr id="toc-row-9" class="sub">
                    <th><a href="#slide9">Basic chat widget</a></th>
                    <td><a href="#slide9">9</a></td>
                </tr>
                
                <tr id="toc-row-10" class="sub">
                    <th><a href="#slide10">Basic chat widget</a></th>
                    <td><a href="#slide10">10</a></td>
                </tr>
                
                <tr id="toc-row-11" class="sub">
                    <th><a href="#slide11">Basic chat widget</a></th>
                    <td><a href="#slide11">11</a></td>
                </tr>
                
                <tr id="toc-row-12" class="sub">
                    <th><a href="#slide12">Basic chat widget</a></th>
                    <td><a href="#slide12">12</a></td>
                </tr>
                
                <tr id="toc-row-13" class="sub">
                    <th><a href="#slide13">Basic chat widget</a></th>
                    <td><a href="#slide13">13</a></td>
                </tr>
                
                <tr id="toc-row-14" class="sub">
                    <th><a href="#slide14">Basic chat widget</a></th>
                    <td><a href="#slide14">14</a></td>
                </tr>
                
                <tr id="toc-row-15" class="sub">
                    <th><a href="#slide15">Basic chat widget</a></th>
                    <td><a href="#slide15">15</a></td>
                </tr>
                
                <tr id="toc-row-16" class="sub">
                    <th><a href="#slide16">Basic chat widget</a></th>
                    <td><a href="#slide16">16</a></td>
                </tr>
                
                <tr id="toc-row-17" class="sub">
                    <th><a href="#slide17">Basic chat widget</a></th>
                    <td><a href="#slide17">17</a></td>
                </tr>
                
                <tr id="toc-row-18" class="sub">
                    <th><a href="#slide18">Basic chat widget</a></th>
                    <td><a href="#slide18">18</a></td>
                </tr>
                
                <tr id="toc-row-19" class="sub">
                    <th><a href="#slide19">Basic chat widget</a></th>
                    <td><a href="#slide19">19</a></td>
                </tr>
                
                <tr id="toc-row-20" class="sub">
                    <th><a href="#slide20">Basic NGSI chat operator</a></th>
                    <td><a href="#slide20">20</a></td>
                </tr>
                
                <tr id="toc-row-21" class="sub">
                    <th><a href="#slide21">Basic NGSI chat operator</a></th>
                    <td><a href="#slide21">21</a></td>
                </tr>
                
                <tr id="toc-row-22" class="sub">
                    <th><a href="#slide22">Basic NGSI chat operator</a></th>
                    <td><a href="#slide22">22</a></td>
                </tr>
                
                <tr id="toc-row-23" class="sub">
                    <th><a href="#slide23">Basic NGSI chat operator</a></th>
                    <td><a href="#slide23">23</a></td>
                </tr>
                
                <tr id="toc-row-24" class="sub">
                    <th><a href="#slide24">Basic NGSI chat operator</a></th>
                    <td><a href="#slide24">24</a></td>
                </tr>
                
                <tr id="toc-row-25" class="sub">
                    <th><a href="#slide25">Basic NGSI chat operator</a></th>
                    <td><a href="#slide25">25</a></td>
                </tr>
                
                <tr id="toc-row-26" class="sub">
                    <th><a href="#slide26">Basic NGSI chat operator</a></th>
                    <td><a href="#slide26">26</a></td>
                </tr>
                
                <tr id="toc-row-27" class="sub">
                    <th><a href="#slide27">Basic NGSI chat operator</a></th>
                    <td><a href="#slide27">27</a></td>
                </tr>
                
                <tr id="toc-row-28" class="sub">
                    <th><a href="#slide28">Basic NGSI chat operator</a></th>
                    <td><a href="#slide28">28</a></td>
                </tr>
                
                <tr id="toc-row-29" class="sub">
                    <th><a href="#slide29">Basic NGSI chat operator</a></th>
                    <td><a href="#slide29">29</a></td>
                </tr>
                
                <tr id="toc-row-30" class="sub">
                    <th><a href="#slide30">Basic NGSI chat operator</a></th>
                    <td><a href="#slide30">30</a></td>
                </tr>
                
                <tr id="toc-row-31" class="sub">
                    <th><a href="#slide31">Basic NGSI chat operator</a></th>
                    <td><a href="#slide31">31</a></td>
                </tr>
                
                
                
                <tr id="toc-row-32">
                    <th><a href="#slide32">-</a></th>
                    <td><a href="#slide32">32</a></td>
                </tr>
                
                
            </table>
        </div>
        
        <div id="help" class="sidebar hidden">
            <h2>Help</h2>
            <table>
                <caption>Help</caption>
                <tr>
                    <th>Table of Contents</th>
                    <td>t</td>
                </tr>
                <tr>
                    <th>Exposé</th>
                    <td>ESC</td>
                </tr>
                <tr>
                    <th>Full screen slides</th>
                    <td>e</td>
                </tr>
                <tr>
                    <th>Presenter View</th>
                    <td>p</td>
                </tr>
                <tr>
                    <th>Source Files</th>
                    <td>s</td>
                </tr>
                <tr>
                    <th>Slide Numbers</th>
                    <td>n</td>
                </tr>
                <tr>
                    <th>Toggle screen blanking</th>
                    <td>b</td>
                </tr>
                <tr>
                    <th>Show/hide slide context</th>
                    <td>c</td>
                </tr>
                <tr>
                    <th>Notes</th>
                    <td>2</td>
                </tr>
                <tr>
                    <th>Help</th>
                    <td>h</td>
                </tr>
            </table>
        </div>
        <script>main()</script>
    </body>
</html>